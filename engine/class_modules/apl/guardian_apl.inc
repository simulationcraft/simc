action_priority_list_t* precombat = get_action_priority_list( "precombat" );
action_priority_list_t* def = get_action_priority_list( "default" );
action_priority_list_t* bear = get_action_priority_list( "bear" );
action_priority_list_t* catweave = get_action_priority_list( "catweave" );

precombat->add_action( "variable,name=If_build,value=1,value_else=0,if=talent.thorns_of_iron.enabled&talent.reinforced_fur.enabled","Executed before combat begins. Accepts non-harmful actions only." );
precombat->add_action( "variable,name=catweave_bear,op=reset" );
precombat->add_action( "variable,name=owlweave_bear,op=reset" );
precombat->add_action( "cat_form,if=(variable.catweave_bear&(cooldown.pause_action.remains|time>30))" );
precombat->add_action( "moonkin_form,if=(!variable.catweave_bear)&(cooldown.pause_action.remains|time>30)" );
precombat->add_action( "heart_of_the_Wild,if=talent.heart_of_the_wild.enabled" );
precombat->add_action( "prowl,if=variable.catweave_bear&(cooldown.pause_action.remains|time>30)" );
precombat->add_action( "bear_form,if=(!buff.prowl.up)" );

def->add_action( "auto_attack,if=!buff.prowl.up","Executed every time the actor is available." );
def->add_action( "use_item,slot=trinket1" );
def->add_action( "use_item,slot=trinket2" );
def->add_action( "use_item,name=djaruun_pillar_of_the_elder_flame,if=dot.moonfire.ticking" );
def->add_action( "potion,if=((talent.heart_of_the_wild.enabled&buff.heart_of_the_wild.up)|((buff.berserk_bear.up|buff.incarnation_guardian_of_ursoc.up)&(!variable.catweave_bear&!variable.owlweave_bear)))" );
def->add_action( "run_action_list,name=catweave,if=(target.cooldown.pause_action.remains|time>=30)&variable.catweave_bear&buff.tooth_and_claw.remains>1.5&(buff.incarnation_guardian_of_ursoc.down&buff.berserk_bear.down)&(cooldown.thrash_bear.remains>0&cooldown.mangle.remains>0&dot.moonfire.remains>=2)|(buff.cat_form.up&energy>25&variable.catweave_bear&buff.tooth_and_claw.remains>1.5)|(buff.heart_of_the_wild.up&energy>90&variable.catweave_bear&buff.tooth_and_claw.remains>1.5)" );
def->add_action( "run_action_list,name=bear" );

bear->add_action( "bear_form,if=!buff.bear_form.up" );
bear->add_action( "heart_of_the_Wild,if=talent.heart_of_the_wild.enabled" );
bear->add_action( "moonfire,cycle_targets=1,if=(((!ticking&target.time_to_die>12)|(refreshable&target.time_to_die>12))&active_enemies<7&talent.fury_of_nature.enabled)|(((!ticking&target.time_to_die>12)|(refreshable&target.time_to_die>12))&active_enemies<4&!talent.fury_of_nature.enabled)" );
bear->add_action( "thrash_bear,target_if=refreshable|(dot.thrash_bear.stack<5&talent.flashing_claws.rank=2|dot.thrash_bear.stack<4&talent.flashing_claws.rank=1|dot.thrash_bear.stack<3&!talent.flashing_claws.enabled)" );
bear->add_action( "bristling_fur,if=!cooldown.pause_action.remains&&cooldown.rage_of_the_sleeper.remains>8" );
bear->add_action( "barkskin,if=buff.bear_form.up" );
bear->add_action( "convoke_the_spirits" );
bear->add_action( "berserk_bear" );
bear->add_action( "incarnation" );
bear->add_action( "lunar_beam" );
bear->add_action( "rage_of_the_sleeper,if=((buff.incarnation_guardian_of_ursoc.down&cooldown.incarnation_guardian_of_ursoc.remains>60)|buff.berserk_bear.down)&rage>75&(!talent.convoke_the_spirits.enabled)|(buff.incarnation_guardian_of_ursoc.up|buff.berserk_bear.up)&rage>75&(!talent.convoke_the_spirits.enabled)|(talent.convoke_the_spirits.enabled)&rage>75" );
bear->add_action( "berserking,if=(buff.berserk_bear.up|buff.incarnation_guardian_of_ursoc.up)" );
bear->add_action( "maul,if=(buff.rage_of_the_sleeper.up&buff.tooth_and_claw.stack>0&active_enemies<=6&!talent.raze.enabled&variable.If_build=0)|(buff.rage_of_the_sleeper.up&buff.tooth_and_claw.stack>0&active_enemies=1&talent.raze.enabled&variable.If_build=0)" );
bear->add_action( "raze,if=buff.rage_of_the_sleeper.up&buff.tooth_and_claw.stack>0&variable.If_build=0&active_enemies>1" );
bear->add_action( "maul,if=(((buff.incarnation.up|buff.berserk_bear.up)&active_enemies<=5&!talent.raze.enabled&(buff.tooth_and_claw.stack>=1))&variable.If_build=0)&cooldown.rage_of_the_sleeper.remains>3|(((buff.incarnation.up|buff.berserk_bear.up)&active_enemies=1&talent.raze.enabled&(buff.tooth_and_claw.stack>=1))&variable.If_build=0)&cooldown.rage_of_the_sleeper.remains>3|(((buff.incarnation.up|buff.berserk_bear.up)&active_enemies<=5&!talent.raze.enabled&(buff.tooth_and_claw.stack>=1))&variable.If_build=0)&buff.rage_of_the_sleeper.up|(((buff.incarnation.up|buff.berserk_bear.up)&active_enemies=1&talent.raze.enabled&(buff.tooth_and_claw.stack>=1))&variable.If_build=0)&buff.rage_of_the_sleeper.up" );
bear->add_action( "raze,if=(buff.incarnation.up|buff.berserk_bear.up)&(variable.If_build=0)&active_enemies>1&cooldown.rage_of_the_sleeper.remains>3|(buff.incarnation.up|buff.berserk_bear.up)&(variable.If_build=0)&active_enemies>1&buff.rage_of_the_sleeper.up" );
bear->add_action( "ironfur,target_if=!debuff.tooth_and_claw_debuff.up,if=!buff.ironfur.up&rage>50&!cooldown.pause_action.remains&variable.If_build=0&!buff.rage_of_the_sleeper.up&cooldown.rage_of_the_sleeper.remains>3&!buff.blazing_thorns.up|rage>90&variable.If_build=0&!buff.rage_of_the_sleeper.up&cooldown.rage_of_the_sleeper.remains>3&!buff.blazing_thorns.up|!debuff.tooth_and_claw_debuff.up,if=!buff.ironfur.up&rage>50&!cooldown.pause_action.remains&variable.If_build=0&buff.rage_of_the_sleeper.up&!buff.blazing_thorns.up|rage>90&variable.If_build=0&buff.rage_of_the_sleeper.up&!buff.blazing_thorns.up" );
bear->add_action( "ironfur,if=rage>90&variable.If_build=1&cooldown.rage_of_the_sleeper.remains>3|(buff.incarnation.up|buff.berserk_bear.up)&rage>20&variable.If_build=1&cooldown.rage_of_the_sleeper.remains>3|rage>90&variable.If_build=1&buff.rage_of_the_sleeper.up|(buff.incarnation.up|buff.berserk_bear.up)&rage>20&variable.If_build=1&buff.rage_of_the_sleeper.up" );
bear->add_action( "raze,if=(buff.tooth_and_claw.up)&active_enemies>1&cooldown.rage_of_the_sleeper.remains>3|(buff.tooth_and_claw.up)&active_enemies>1&buff.rage_of_the_sleeper.up" );
bear->add_action( "raze,if=(variable.If_build=0)&active_enemies>1&cooldown.rage_of_the_sleeper.remains>3|(variable.If_build=0)&active_enemies>1&buff.rage_of_the_sleeper.up" );
bear->add_action( "mangle,if=buff.gore.up&active_enemies<11|buff.vicious_cycle_mangle.stack=3" );
bear->add_action( "maul,if=(buff.tooth_and_claw.up&active_enemies<=5&!talent.raze.enabled)&cooldown.rage_of_the_sleeper.remains>3|(buff.tooth_and_claw.up&active_enemies=1&talent.raze.enabled)&cooldown.rage_of_the_sleeper.remains>3|(buff.tooth_and_claw.up&active_enemies<=5&!talent.raze.enabled)&buff.rage_of_the_sleeper.up|(buff.tooth_and_claw.up&active_enemies=1&talent.raze.enabled)&buff.rage_of_the_sleeper.up" );
bear->add_action( "maul,if=(active_enemies<=5&!talent.raze.enabled&variable.If_build=0)&cooldown.rage_of_the_sleeper.remains>3|(active_enemies=1&talent.raze.enabled&variable.If_build=0)&cooldown.rage_of_the_sleeper.remains>3|(active_enemies<=5&!talent.raze.enabled&variable.If_build=0)&buff.rage_of_the_sleeper.up|(active_enemies=1&talent.raze.enabled&variable.If_build=0)&buff.rage_of_the_sleeper.up" );
bear->add_action( "thrash_bear,target_if=active_enemies>=5" );
bear->add_action( "swipe,if=buff.incarnation_guardian_of_ursoc.down&buff.berserk_bear.down&active_enemies>=11" );
bear->add_action( "mangle,if=(buff.incarnation.up&active_enemies<=4)|(buff.incarnation.up&talent.soul_of_the_forest.enabled&active_enemies<=5)|((rage<90)&active_enemies<11)|((rage<85)&active_enemies<11&talent.soul_of_the_forest.enabled)" );
bear->add_action( "thrash_bear,if=active_enemies>1" );
bear->add_action( "pulverize,target_if=dot.thrash_bear.stack>2" );
bear->add_action( "thrash_bear" );
bear->add_action( "moonfire,if=buff.galactic_guardian.up" );
bear->add_action( "swipe_bear" );

catweave->add_action( "heart_of_the_wild,if=talent.heart_of_the_wild.enabled&!buff.heart_of_the_wild.up&!buff.cat_form.up" );
catweave->add_action( "cat_form,if=!buff.cat_form.up" );
catweave->add_action( "rake,if=buff.prowl.up" );
catweave->add_action( "heart_of_the_wild,if=talent.heart_of_the_wild.enabled&!buff.heart_of_the_wild.up" );
catweave->add_action( "rake,if=dot.rake.refreshable|energy<45" );
catweave->add_action( "rip,if=dot.rip.refreshable&combo_points>=1" );
catweave->add_action( "convoke_the_spirits" );
catweave->add_action( "ferocious_bite,if=combo_points>=4&energy>50" );
catweave->add_action( "shred,if=combo_points<=5" );
