action_priority_list_t* precombat = get_action_priority_list( "precombat" );
action_priority_list_t* def = get_action_priority_list( "default" );
action_priority_list_t* cat = get_action_priority_list( "cat" );
action_priority_list_t* owl = get_action_priority_list( "owl" );

precombat->add_action( "heart_of_the_wild","Executed before combat begins. Accepts non-harmful actions only." );
precombat->add_action( "cat_form,if=talent.rake.enabled" );
precombat->add_action( "prowl,if=talent.rake.enabled" );
precombat->add_action( "moonkin_form,if=talent.moonkin_form.enabled&!talent.rake.enabled" );

def->add_action( "berserking","Executed every time the actor is available." );
def->add_action( "natures_vigil,if=!buff.prowl.up&!buff.shadowmeld.up" );
def->add_action( "regrowth,if=!buff.prowl.up&!buff.shadowmeld.up&druid.time_spend_healing,line_cd=7" );
def->add_action( "use_items,if=!buff.prowl.up&!buff.shadowmeld.up" );
def->add_action( "potion,if=!buff.prowl.up&!buff.shadowmeld.up" );
def->add_action( "run_action_list,name=cat,if=talent.rake.enabled" );
def->add_action( "run_action_list,name=owl,if=active_enemies>2&talent.moonkin_form.enabled&cooldown.convoke_the_spirits.remains<=gcd.max&(buff.heart_of_the_wild.up|cooldown.heart_of_the_wild.remains>60-30*talent.cenarius_guidance.enabled|!talent.heart_of_the_wild.enabled)" );
def->add_action( "moonkin_form,if=talent.moonkin_form.enabled" );
def->add_action( "convoke_the_spirits,if=(buff.heart_of_the_wild.up|cooldown.heart_of_the_wild.remains>60-30*talent.cenarius_guidance.enabled|!talent.heart_of_the_wild.enabled)" );
def->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=2&dot.adaptive_swarm_damage.remains>2" );
def->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=1&dot.adaptive_swarm_damage.remains>2" );
def->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=3&dot.adaptive_swarm_damage.remains>2" );
def->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=4&dot.adaptive_swarm_damage.remains>2" );
def->add_action( "adaptive_swarm,target_if=!dot.adaptive_swarm_damage.ticking" );
def->add_action( "sunfire,target_if=refreshable&target.time_to_die>5&talent.improved_sunfire.enabled" );
def->add_action( "moonfire,target_if=refreshable&time_to_die>12" );
def->add_action( "starsurge" );
def->add_action( "sunfire,target_if=refreshable&target.time_to_die>7&active_enemies<7" );
def->add_action( "starfire,if=spell_targets.starfire>1" );
def->add_action( "wrath" );

cat->add_action( "rake,if=buff.shadowmeld.up|buff.prowl.up|buff.sudden_ambush.up" );
cat->add_action( "auto_attack,if=!buff.prowl.up&!buff.shadowmeld.up" );
cat->add_action( "natures_vigil,if=!buff.prowl.up&!buff.shadowmeld.up" );
cat->add_action( "heart_of_the_wild,if=(cooldown.convoke_the_spirits.remains<30|!covenant.night_fae)&!buff.heart_of_the_wild.up" );
cat->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=2&dot.adaptive_swarm_damage.remains>2" );
cat->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=1&dot.adaptive_swarm_damage.remains>2" );
cat->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=3&dot.adaptive_swarm_damage.remains>2" );
cat->add_action( "adaptive_swarm,target_if=dot.adaptive_swarm_damage.stack=4&dot.adaptive_swarm_damage.remains>2" );
cat->add_action( "adaptive_swarm,target_if=!dot.adaptive_swarm_damage.ticking" );
cat->add_action( "run_action_list,name=owl,if=active_enemies>2&talent.moonkin_form.enabled&cooldown.convoke_the_spirits.remains<=gcd.max&(buff.heart_of_the_wild.up|cooldown.heart_of_the_wild.remains>60-30*talent.cenarius_guidance.enabled|!talent.heart_of_the_wild.enabled)" );
cat->add_action( "cat_form,if=(active_enemies<2|!talent.moonkin_form.enabled)&(!buff.cat_form.up&cooldown.convoke_the_spirits.remains<=gcd.max&(buff.heart_of_the_wild.up|cooldown.heart_of_the_wild.remains>60-30*talent.cenarius_guidance.enabled|!talent.heart_of_the_wild.enabled))" );
cat->add_action( "convoke_the_spirits,if=(buff.heart_of_the_wild.up|cooldown.heart_of_the_wild.remains>60-30*talent.cenarius_guidance.enabled|!talent.heart_of_the_wild.enabled)" );
cat->add_action( "rip,if=remains<=gcd&combo_points>0&dot.adaptive_swarm_damage.ticking" );
cat->add_action( "thrash_cat,target_if=refreshable&target.time_to_die>5&spell_targets.thrash_cat>1" );
cat->add_action( "sunfire,target_if=(refreshable&target.time_to_die>5)&!prev_gcd.1.cat_form&(active_enemies=1|talent.improved_sunfire.enabled)" );
cat->add_action( "cat_form,if=!buff.cat_form.up&energy>50&(dot.thrash_cat.refreshable&spell_targets.swipe_cat>=9&talent.thrash.enabled)" );
cat->add_action( "moonfire,target_if=(refreshable&time_to_die>12&!ticking|(prev_gcd.1.sunfire&remains<duration*0.8&spell_targets.sunfire=1))&!prev_gcd.1.cat_form" );
cat->add_action( "sunfire,if=prev_gcd.1.moonfire&remains<duration*0.8" );
cat->add_action( "starfire,if=time_to_die<10&spell_targets.starfire>1&(!talent.swipe.enabled|spell_targets.swipe_cat>=9)" );
cat->add_action( "starsurge,if=active_enemies=1|(active_enemies<5&!buff.cat_form.up)" );
cat->add_action( "cat_form,if=!buff.cat_form.up&energy>50" );
cat->add_action( "ferocious_bite,if=(combo_points>3&target.1.time_to_die<3)|(combo_points=5&energy>=50&dot.rip.remains>10)&spell_targets.swipe_cat<4" );
cat->add_action( "thrash_cat,target_if=refreshable&target.time_to_die>5&spell_targets.thrash_cat>2" );
cat->add_action( "rake,target_if=dot.adaptive_swarm_damage.ticking&refreshable" );
cat->add_action( "rip,target_if=((refreshable|energy>90&remains<=10)&(combo_points=5&time_to_die>remains+24|(remains+combo_points*4<time_to_die&remains+4+combo_points*4>time_to_die))|!ticking&combo_points>2+spell_targets.swipe_cat*2)" );
cat->add_action( "rake,target_if=(refreshable&time_to_die>10&spell_targets.swipe_cat<10)&(combo_points<5|remains<1)" );
cat->add_action( "sunfire,target_if=refreshable&target.time_to_die>5&active_enemies<7&!talent.improved_sunfire.enabled" );
cat->add_action( "thrash_cat,target_if=refreshable&target.time_to_die>5" );
cat->add_action( "swipe_cat,if=active_enemies>1&combo_points<5" );
cat->add_action( "shred,if=energy>60&combo_points<5" );

owl->add_action( "moonkin_form,if=!buff.moonkin_form.up" );
owl->add_action( "convoke_the_spirits" );
