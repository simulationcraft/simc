# Jom - Discipline - 2023-03-01 16:08 - US/Spinebreaker
# SimC Addon 10.0.5-01
# WoW 10.0.5.48317, TOC 100005
# Requires SimulationCraft 1000-01 or newer
debug=1
use_item_verification=0
html="jom.html"
priest="Jom"
source=default
spec=discipline
level=70
race=blood_elf
role=spell
position=ranged_back
talents=BAQA16pR6xQxvK1VWhXk+w0/GAAIlEJQSSKRkmUSSSQAAAAAAAAAAAgESakWCh0IkEEUkWikAA
optimal_raid=0

head=,id=200327,gem_id=192945,bonus_id=6652/7935/8828/9130/7977/1495/8767
neck=,id=193001,gem_id=192945/192945/192984,bonus_id=8836/8840/8902/8960/8784/8782/8802/8790/8846,crafted_stats=40/36
shoulder=,id=200329,bonus_id=6652/8826/7977/8973/1489/8767
back=,id=193511,enchant_id=6598,bonus_id=8836/8840/8902/8802/8846/8790/8932/8960,crafted_stats=36/32
chest=,id=200324,enchant_id=6619,bonus_id=6652/7977/8974/8830/1495
wrist=,id=134310,enchant_id=6580,gem_id=192945,bonus_id=7977/6652/7935/8822/8819/9144/8973/3294/8767
hands=,id=193713,bonus_id=7977/6652/8822/8817/9144/8973/1637/8767
waist=,id=137488,bonus_id=7977/6652/7936/8822/8818/9144/8973/3294/8767
legs=,id=200328,enchant_id=6544,bonus_id=6652/7977/8827/8973/1498/8767
feet=,id=134308,enchant_id=6613,bonus_id=9130/7977/6652/8822/8818/9144/3300/8767
finger1=,id=192999,enchant_id=6556,gem_id=192945,bonus_id=8836/8840/8902/8780/8802/8790/8846,crafted_stats=49/36
finger2=,id=195526,enchant_id=6556,bonus_id=6652/7937/7980/1485/8767
trinket1=,id=110007,bonus_id=7977/6652/9144/8973/3300/8767
trinket2=,id=193677,bonus_id=7977/6652/9144/8973/1637/8767
main_hand=,id=193699,enchant_id=6643,bonus_id=9130/7977/6652/9147/1643/8767

profileset."Test hotness two"+="talents=BAQA16pR6xQxvK1VWhXk+w0/GAAIlEJEJJpEkWLlkkEEAAAAAAAAAAAIhkGplQINCJBBFplIJAA"
profileset."Test hotness"+="talents=BAQA16pR6xQxvK1VWhXk+w0/GAAIlEJQSSKHQkWLlkkEEAAAAAAAAAAAIhkGplQINCJBBFplIJAA"
profileset."Long Scov/TE/MB"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUIJQSkSSSaSJJJCAAAAAAAAAAAAIpFKJJi0ISEEUaRikAA"
profileset."Short Scov/TE/MB"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUIJQSkWSSaSJJJCAAAAAAAAAAAAIpFKJJi0ISEEUaRikAA"
profileset."Long Scov/TE/MB/Solace"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUIJQSkSSSatUSSCAAAAAAAAAAAAgkWokkISjIRQQpFJSCA"
profileset."Short Scov/TE/MB/Solace"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUIJQSkWSSatUSSCAAAAAAAAAAAAgkWokkISjIRQQpFJSCA"
profileset."Long Scov/MB/Solace"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUICkEpkkkWLlkkIAAAAAAAAAAAAgkWokkISjIRQQpFJSCA"
profileset."Short Scov/MB/Solace"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUICkEplkkWLlkkIAAAAAAAAAAAAgkWokkISjIRQQpFJSCA"
profileset."Long Scov/MB/Solace/Painful/Malicious"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIFSCkkkyBSSatUSSSAAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Short Scov/MB/Solace/Painful/Malicious"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIFSCkkk2BSSatUSSSAAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Long Scov/TE/WW"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJRKRkmUSSiQAAAAAAAAAAAAIpFKJJi0ISEEUaRikAA"
profileset."Short Scov/TE/WW"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJRaRkmUSSiQAAAAAAAAAAAAIpFKJJi0ISEEUaRikAA"
profileset."Long Scov/TE/WW/Solace"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJRKRkWLlkkABAAAAAAAAAAAgkWokkISjIRQQpFJSCA"
profileset."Short Scov/TE/WW/Solace"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJRaRkWLlkkABAAAAAAAAAAAgkWokkISjIRQQpFJSCA"
profileset."Long Scov/TE/WW/Solace/Malicious"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJJpcARatUSSCEAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Short Scov/TE/WW/Solace/Malicious"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJJpdARatUSSCEAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Long Scov/TE/WW/Solace/Painful"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJRKHQkWLlkkEEAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Short Scov/TE/WW/Solace/Painful"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAkUSkAJRaHQkWLlkkEEAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Long Scov/TE/WW/Solace/Painful/Malicious"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSSKHQkWLlkkEEAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Short Scov/TE/WW/Solace/Painful/Malicious"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSSaHQkWLlkkEEAAAAAAAAAAAIhkGpkQINiEBBlWkIJAA"
profileset."Long Scov/TE/WW/Borrowed"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSkyBEp1SJJJIBAAAAAAAAAAAgkGpkQINiEREUaRikgSA"
profileset."Short Scov/TE/WW/Borrowed"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSk2BEp1SJJJIBAAAAAAAAAAAgkGpkQINiEREUaRikgSA"
profileset."WW/WU/Borrowed"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAISIJRSCQatUSSSiEAAAAAAAAAAAASakSCh0ISERQpFJSCKB"
profileset."Uhhhhh"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSSaEp1SJJJJEAAAAAAAAAAAIBakSCh0ISERQpFJSCKB"
profileset."Crazy WW/TE"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSCEp1SJJJJSAAAAAAAAAAAgEoRKJESjIREBlWkIJoEA"
profileset."Weird WW"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlECRSCEp1SJJJJSAAAAAAAAAAAAIpRKJESjIREBlWkIJoEA"
profileset."Weird WW with mindgames"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlECRSCEp1SJJJJSAAAAAAAAAAAgEBkSCh0ISERQpFJSCKB"
profileset."Weird WW again"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSCEp1SJJJJSAAAAAAAAAAAAIpRKJESjIREBlWkIJoEA"
profileset."Weird WW the third"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSSKEp1SJJJJEAAAAAAAAAAAASakSCh0ISERQpFJSCKB"
profileset."Weird WW with TE"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSCEp1SJJJJSAAAAAAAAAAAgEBkSCh0ISERQpFJSCKB"
profileset."Weird WW with TE and halo"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSCEp1SJJJJSAAAAAAAAAAAgEBkWCh0ISERQpFJSCKB"
profileset."Weird WW with TE and halo and no borrowed"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSCEp1SJJJJRAAAAAAAAAAAgEBkWCh0ISERQpFJSCKB"
profileset."Weird TE"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlQCRSCEp1SJJJJSAAAAAAAAAAAAIpRKJESjIREBlWkIJoEA"
profileset."weird wrath unleashed"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIFkkEJJQkWLlkkkIAAAAAAAAAAAAIpRKJESjIREBlWkIJoEA"
profileset."other weird wrath unleashed"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAISIJRSCQatUSSSiEAAAAAAAAAAAASakSCh0ISERQpFJSCKB"
profileset."the hotness with halo"+="talents=BAQAAAAAAAAAAAAAAAAAAAAAAAAIlEJQSCEp1SJJJJSAAAAAAAAAAAgEBkWCh0ISERQpFJSCKB"

# check fight styles with aoe
# log all the build varieties in sheet
# Jom - Holy - 2023-03-16 18:38 - US/Spinebreaker

# potion=elemental_potion_of_ultimate_power_3
# flask=phial_of_tepid_versatility_3
# food=fated_fortune_cookie
# augmentation=draconic_augment_rune
# temporary_enchant=main_hand:howling_rune_3

# Executed before combat begins. Accepts non-harmful actions only.
# actions.precombat=flask
# actions.precombat+=/food
# actions.precombat+=/augmentation
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+=/snapshot_stats

# RUN ACTIONS
actions+=/run_action_list,name=main

# MAIN VARIABLES
actions.main_variables+=/variable,name=te_none,op=set,value=talent.twilight_equilibrium.enabled&!buff.twilight_equilibrium_holy_amp.up&!buff.twilight_equilibrium_shadow_amp.up
actions.main_variables+=/variable,name=te_shadow,op=set,value=talent.twilight_equilibrium.enabled&(buff.twilight_equilibrium_shadow_amp.up|variable.te_none)
actions.main_variables+=/variable,name=te_holy,op=set,value=talent.twilight_equilibrium.enabled&(buff.twilight_equilibrium_holy_amp.up|variable.te_none)
actions.main_variables+=/variable,name=ptw_up,op=set,value=talent.purge_the_wicked.enabled&dot.purge_the_wicked.ticking
actions.main_variables+=/variable,name=swp_up,op=set,value=dot.shadow_word_pain.ticking
actions.main_variables+=/variable,name=harsh_discipline_ready,op=set,value=talent.harsh_discipline.enabled&buff.harsh_discipline_ready.up


# SHADOW COVENANT VARIABLES
# In general, we have two paths:
# Short Shadow Covenant - prioritize shadow damage until buff falls off
# Long Shadow Covenant - we have enough time to weave in holy spells to benefit
# from Twilight Equilibrium

# Is shadow covenant available or active?
actions.main_variables+=/variable,name=scov_available,op=set,value=talent.shadow_covenant.enabled&(cooldown.shadow_covenant.up|buff.shadow_covenant.up)
# Is shadow covenant unavailable?
actions.main_variables+=/variable,name=scov_unavailable,op=set,value=!talent.shadow_covenant.enabled|(talent.shadow_covenant.enabled&!buff.shadow_covenant.up&!cooldown.shadow_covenant.up)
# Do we have long scov?
actions.main_variables+=/variable,name=long_scov,op=set,value=talent.shadow_covenant.enabled&talent.embrace_shadow.enabled
# Do we have short scov?
actions.main_variables+=/variable,name=short_scov,op=set,value=talent.shadow_covenant.enabled&!talent.embrace_shadow.enabled

# SHORT SHADOW COVENANT VARIABLES
# Will penance be available again for our next ramp window?
actions.s_scov_variables+=/variable,name=s_scov_can_penance,op=set,value=(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time)>action.penance.cooldown

# Will SWD be available again for our next ramp window?
# Prepare to use after penance if target health < 20%
# Prepare to use after mindblast if target health >= 20%
actions.s_scov_variables+=/variable,name=s_scov_can_swd,op=set,value=(target.health.pct>=20&((cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time+(2*action.mind_blast.execute_time))>action.shadow_word_death.cooldown))|(target.health.pct<20&((cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time)>action.shadow_word_death.cooldown))

# Will 2x Mind Blast be available again for our next ramp window?
# Prepare to use after penance if target health >= 20%
# Prepare to use after SW:D if target health < 20%
actions.s_scov_variables+=/variable,name=s_scov_can_mind_blast,op=set,value=(target.health.pct>=20&(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time)>(((action.mind_blast.max_charges-action.mind_blast.charges_fractional)*action.mind_blast.recharge_time)+action.mind_blast.execute_time))|(target.health.pct<20&(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time+(2*action.shadow_word_death.execute_time))>(((action.mind_blast.max_charges-action.mind_blast.charges_fractional)*action.mind_blast.recharge_time)+action.mind_blast.execute_time))

# LONG SHADOW COVENANT VARIABLES
# Will penance be available again for our next ramp window?
actions.l_scov_variables+=/variable,name=l_scov_can_penance,op=set,value=(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time)>action.penance.cooldown

# Will SWD be available again for our next ramp window?
# Prepare to use after penance if target health < 20%
# Prepare to use after mindblast/solace if target health >= 20%
actions.l_scov_variables+=/variable,name=l_scov_can_swd,op=set,value=(target.health.pct>=20&((cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time+(2*action.mind_blast.execute_time)+action.power_word_solace.execute_time)>action.shadow_word_death.cooldown))|(target.health.pct<20&((cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time)>action.shadow_word_death.cooldown))

# Will 2x Mind Blast be available again for our next ramp window?
# Prepare to use after penance if target health >= 20%
# Prepare to use after SW:D if target health < 20%
actions.l_scov_variables+=/variable,name=l_scov_can_mind_blast,op=set,value=(target.health.pct>=20&(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time)>(((action.mind_blast.max_charges-action.mind_blast.charges_fractional)*action.mind_blast.recharge_time)+action.mind_blast.execute_time))|(target.health.pct<20&(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time+(2*action.shadow_word_death.execute_time))>(((action.mind_blast.max_charges-action.mind_blast.charges_fractional)*action.mind_blast.recharge_time)+action.mind_blast.execute_time))

# Will Mindgames be available again for our next ramp window?
# Assumption: we get roughly 8 manipulation procs per filler cycle
actions.l_scov_variables+=/variable,name=l_scov_can_mindgames,op=set,value=(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time+(2*action.mind_blast.execute_time)+action.shadow_word_death.execute_time+action.power_word_solace.execute_time-(talent.manipulation.rank*8))>action.mindgames.cooldown


# Will Solace be available again for our next ramp window?
# Assumption: we get roughly 8 manipulation procs per filler cycle
actions.l_scov_variables+=/variable,name=l_scov_can_solace,op=set,value=(cooldown.shadow_covenant.remains+action.shadow_covenant.execute_time+action.schism.execute_time+action.penance.execute_time+action.mind_blast.execute_time)>action.power_word_solace.cooldown




# START MAIN
actions.main+=/call_action_list,name=main_variables
actions.main+=/call_action_list,name=cooldowns

# PTW if it's not up at all, unless we're in short shadow covenant window
actions.main+=/purge_the_wicked,if=talent.purge_the_wicked.enabled&!variable.ptw_up&!(variable.short_scov&buff.shadow_covenant.up)
# PTW to max before short scov
actions.main+=/purge_the_wicked,if=talent.purge_the_wicked.enabled&variable.short_scov&cooldown.shadow_covenant.up&dot.purge_the_wicked.remains<23
# Refresh PTW when its refreshable, but not if we have painful punishment to refresh it in time and not if we're inside short shadow covenant
actions.main+=/purge_the_wicked,if=talent.purge_the_wicked.enabled&!(variable.short_scov&buff.shadow_covenant.up)&(refreshable&(!talent.painful_punishment.enabled|(talent.painful_punishment.enabled&(cooldown.penance.remains>dot.purge_the_wicked.remains))))
# Same as above, but for SW:P
actions.main+=/shadow_word_pain,if=!talent.purge_the_wicked.enabled&target.time_to_die>=10&(!variable.swp_up|(variable.short_scov&cooldown.shadow_covenant.up&dot.shadow_word_pain.remains<23)|(refreshable&(!talent.painful_punishment.enabled|(talent.painful_punishment.enabled&(cooldown.penance.remains>dot.shadow_word_pain.remains)))))

actions.main+=/power_word_shield,if=talent.borrowed_time.enabled&!buff.light_weaving.up

# basic rotation when no scov
actions.main+=/run_action_list,name=no_scov,if=!talent.shadow_covenant.enabled
# enter short scov ramp if scov is available and we have short scov
actions.main+=/run_action_list,name=s_scov_ramp,if=variable.short_scov&variable.scov_available
# enter long scov ramp if scov is available and we have long scov
actions.main+=/run_action_list,name=l_scov_ramp,if=variable.long_scov&variable.scov_available
# fillers if we can't enter scov yet
actions.main+=/call_action_list,name=short_scov_filler,if=talent.shadow_covenant.enabled&variable.short_scov&variable.scov_unavailable
actions.main+=/call_action_list,name=long_scov_filler,if=talent.shadow_covenant.enabled&variable.long_scov&variable.scov_unavailable


# TODO
# shadowfiend
actions.no_scov+=/shadowfiend,if=!talent.mindbender.enabled
# mindbender
actions.no_scov+=/mindbender,if=talent.mindbender.enabled
actions.no_scov+=/schism
actions.no_scov+=/penance
actions.no_scov+=/lights_wrath,if=talent.lights_wrath.enabled
actions.no_scov+=/shadow_word_death,if=target.health.pct<20
actions.no_scov+=/mind_blast
actions.no_scov+=/power_word_solace,if=talent.power_word_solace.enabled
actions.no_scov+=/smite,if=!talent.expiation.enabled&(buff.wrath_unleashed.up&buff.weal_and_woe.stack>=4)
actions.no_scov+=/mindgames,if=talent.mindgames.enabled
actions.no_scov+=/divine_star,if=talent.divine_star.enabled
actions.no_scov+=/halo,if=talent.halo.enabled
actions.no_scov+=/shadow_word_death
actions.no_scov+=/smite

# SHORT SHADOW COVENANT FILLER
actions.short_scov_filler+=/call_action_list,name=s_scov_variables
# penance when CD will be back before scov
actions.short_scov_filler+=/penance,if=variable.s_scov_can_penance&variable.te_holy
# light's wrath as filler only if we're running short scov because it won't fit in our ramp window
actions.short_scov_filler+=/lights_wrath,if=talent.lights_wrath.enabled&variable.te_holy
# sw:d in execute phase
actions.short_scov_filler+=/shadow_word_death,if=variable.s_scov_can_swd&target.health.pct<20&variable.te_shadow
# smite becomes higher priority when we aren't taking expiation and wrath_unleashed is up while weal and woe is stacked >= 4
actions.short_scov_filler+=/smite,if=!talent.expiation.enabled&(buff.wrath_unleashed.up&buff.weal_and_woe.stack>=4)
# mind blast when scov is down and CD will be back before scov
actions.short_scov_filler+=/mind_blast,if=variable.s_scov_can_mind_blast&variable.te_shadow
# mindgames only when TE is available
actions.short_scov_filler+=/mindgames,if=variable.te_shadow
#solace when scov is down and CD will return before next scov cycle
actions.short_scov_filler+=/power_word_solace,if=talent.power_word_solace.enabled&variable.te_holy
# divine star
actions.short_scov_filler+=/divine_star,if=variable.te_holy
# later SW:D if not in execute phase
actions.short_scov_filler+=/shadow_word_death,if=variable.s_scov_can_swd&variable.te_shadow
# if all else fails, low prio smite
actions.short_scov_filler+=/smite


# ----- SHORT SCOV RAMP ROTATION - 7 seconds
# Focus on shadow spells only because the timing is short
# shadowfiend before entering scov
actions.s_scov_ramp+=/shadowfiend,if=!talent.mindbender.enabled&!buff.shadow_covenant.up&!buff.schism.up
# mindbender before entering scov
actions.s_scov_ramp+=/mindbender,if=talent.mindbender.enabled&!buff.shadow_covenant.up&!buff.schism.up
# halo if we are about to scov
actions.s_scov_ramp+=/halo,if=talent.halo.enabled
# shadow covenant before anything
actions.s_scov_ramp+=/shadow_covenant
# schism
actions.s_scov_ramp+=/schism
# penance
actions.s_scov_ramp+=/penance,if=buff.shadow_covenant.up
# sw:d earlier if execute phase
actions.s_scov_ramp+=/shadow_word_death,if=buff.shadow_covenant.up&target.health.pct<20
# Mind Blast
actions.s_scov_ramp+=/mind_blast,if=buff.shadow_covenant.up
# divine star for high target count
actions.s_scov_ramp+=/divine_star,if=buff.shadow_covenant.up&spell_targets.divine_star>=3
# mindgames only if we also have shattered perceptions
actions.s_scov_ramp+=/mindgames,if=buff.shadow_covenant.up&talent.shattered_perceptions.enabled
# sw:d later if not execute phase
actions.s_scov_ramp+=/shadow_word_death,if=buff.shadow_covenant.up


# LONG SHADOW COVENANT FILLER
actions.long_scov_filler+=/call_action_list,name=l_scov_variables
# penance when CD will be back before scov
actions.long_scov_filler+=/penance,if=variable.l_scov_can_penance&variable.te_holy
# sw:d in execute phase
actions.long_scov_filler+=/shadow_word_death,if=variable.l_scov_can_swd&target.health.pct<20&variable.te_shadow
# smite becomes higher priority when we aren't taking expiation and wrath_unleashed is up while weal and woe is stacked >= 4
actions.long_scov_filler+=/smite,if=!talent.expiation.enabled&(buff.wrath_unleashed.up&buff.weal_and_woe.stack>=4)
# mind blast when scov is down and CD will be back before scov
actions.long_scov_filler+=/mind_blast,if=variable.l_scov_can_mind_blast&variable.te_shadow
# mindgames only when TE is available
actions.long_scov_filler+=/mindgames,if=variable.te_shadow
#solace when scov is down and CD will return before next scov cycle
actions.long_scov_filler+=/power_word_solace,if=talent.power_word_solace.enabled&variable.te_holy
# divine star
actions.long_scov_filler+=/divine_star,if=variable.te_holy
# later SW:D if not in execute phase
actions.long_scov_filler+=/shadow_word_death,if=variable.l_scov_can_swd&variable.te_shadow
# if all else fails, low prio smite
actions.long_scov_filler+=/smite


# ----- LONG SCOV RAMP ROTATION - 15 sec
# Weave in twilight equilibrium for longer scov
# shadowfiend before entering scov
# prepping harsh discipline is a DPS loss
# actions.l_scov_ramp+=/smite,if=talent.harsh_discipline.enabled&!buff.shadow_covenant.up&((!talent.power_word_solace.enabled&!buff.harsh_discipline_ready.up)|(talent.power_word_solace.enabled&buff.harsh_discipline.stack<3))

actions.l_scov_ramp+=/shadowfiend,if=!talent.mindbender.enabled
# mindbender before entering scov
actions.l_scov_ramp+=/mindbender,if=talent.mindbender.enabled
# halo if we are about to enter scov
actions.l_scov_ramp+=/halo,if=talent.halo.enabled
# shadow covenant
actions.l_scov_ramp+=/shadow_covenant
# schism
actions.l_scov_ramp+=/schism,if=buff.shadow_covenant.up
# penance only once scov is active
actions.l_scov_ramp+=/penance,if=buff.shadow_covenant.up&variable.te_shadow
# light's wrath while schism is up
actions.l_scov_ramp+=/lights_wrath,if=talent.lights_wrath.enabled&buff.shadow_covenant.up&variable.te_holy
# sw:d earlier if execute phase
actions.l_scov_ramp+=/shadow_word_death,if=buff.shadow_covenant.up&target.health.pct<20&variable.te_shadow
# Mind Blast
actions.l_scov_ramp+=/mind_blast,if=buff.shadow_covenant.up&variable.te_shadow
# divine star for high target count
actions.l_scov_ramp+=/divine_star,if=buff.shadow_covenant.up&variable.te_shadow&spell_targets.divine_star>=3
# mindgames
actions.l_scov_ramp+=/mindgames,if=buff.shadow_covenant.up&variable.te_shadow
# Solace
actions.l_scov_ramp+=/power_word_solace,if=talent.power_word_solace.enabled&buff.shadow_covenant.up&variable.te_holy
# PTW
actions.l_scov_ramp+=/purge_the_wicked,if=buff.shadow_covenant.up&variable.te_holy&(refreshable|!variable.ptw_up)
# divine star for low target count
actions.l_scov_ramp+=/divine_star,if=buff.shadow_covenant.up&variable.te_shadow
# sw:d later if not execute phase
actions.l_scov_ramp+=/shadow_word_death,if=buff.shadow_covenant.up&variable.te_shadow
# PTW
actions.l_scov_ramp+=/smite,if=buff.shadow_covenant.up&variable.te_holy

# CDs
# hold PI to use with shadow covenant if we have it
actions.cooldowns+=/power_infusion,if=!talent.shadow_covenant.enabled|(talent.shadow_covenant.enabled&(cooldown.shadow_covenant.up|buff.shadow_covenant.up))
# sync potion with PI
# actions.cooldowns+=/potion,if=buff.power_infusion.up
# sync trinkets with PI
actions.cooldowns+=/use_items,if=buff.power_infusion.up|cooldown.power_infusion.remains>=cooldown