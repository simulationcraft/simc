single_actor_batch="1"
desired_targets="1"
target_error="0.1"
iterations="100000"
max_time="300"

report_details="1"
ptr="1"


deathknight="T28_Death_Knight_Unholy_Baseline"
source="default"
spec="unholy"
level="60"
race="troll"
role="attack"
position="back"
talents="2303021"
covenant="necrolord"
soulbind="plague_deviser_marileth,volatile_solvent/kevins_oozeling/brutal_grasp:11:1/eternal_hunger:11:1/convocation_of_the_dead:11:1"
renown="80"
set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=0"

# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/raise_dead"
actions.precombat+="/fleshcraft"
actions.precombat+="/army_of_the_dead,precombat_time=3,if=!talent.summon_gargoyle"
# Evaluates a trinkets cooldown, divided by 45. This was chosen as unholy works on 45 second burst cycles, but has too many cdr effects to give a cooldown.x.duration divisor instead. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(trinket.1.cooldown.duration%%45=0)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(trinket.2.cooldown.duration%%45=0)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
# Evaluates current setup for the quantity of Apocalypse CDR effects
actions.precombat+="/variable,name=full_cdr,value=talent.army_of_the_damned&conduit.convocation_of_the_dead"

# Executed every time the actor is available.
actions="auto_attack"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
# Variables
actions+="/variable,name=pooling_runic_power,value=cooldown.summon_gargoyle.remains<5&talent.summon_gargoyle&(talent.unholy_blight&cooldown.unholy_blight.remains<13&cooldown.dark_transformation.remains_expected<13|!talent.unholy_blight)"
actions+="/variable,name=pooling_runes,value=talent.soul_reaper&rune<2&target.time_to_pct_35<5&fight_remains>5"
actions+="/variable,name=st_planning,value=active_enemies=1&(!raid_event.adds.exists|raid_event.adds.in>15)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=major_cooldowns_active,value=(talent.summon_gargoyle&!pet.gargoyle.active&cooldown.summon_gargoyle.remains|!talent.summon_gargoyle)&(buff.unholy_assault.up|talent.army_of_the_damned&pet.apoc_ghoul.active|buff.dark_transformation.up|active_enemies>=2&death_and_decay.ticking)"
actions+="/variable,name=dump_wounds,value=covenant.night_fae&death_and_decay.ticking&buff.deaths_due.stack<4|buff.marrowed_gemstone_enhancement.up|buff.thrill_seeker.up|buff.frenzied_monstrosity.up|buff.lead_by_example.up|buff.chaos_bane.up|cooldown.unholy_assault.remains<5"
# Maintaining Virulent Plague is a priority
actions+="/outbreak,if=dot.virulent_plague.refreshable&!talent.unholy_blight&!raid_event.adds.exists"
actions+="/outbreak,target_if=dot.virulent_plague.refreshable&active_enemies>=2&(!talent.unholy_blight|talent.unholy_blight&(cooldown.unholy_blight.remains>(15%active_enemies+dot.virulent_plague.remains)|active_enemies>=3))"
actions+="/outbreak,if=runeforge.superstrain&(dot.frost_fever.refreshable|dot.blood_plague.refreshable)"
# Refreshes Deaths Due's buff just before deaths due ends
actions+="/wound_spender,if=covenant.night_fae&death_and_decay.active_remains<(gcd*1.5)&death_and_decay.ticking"
actions+="/wait_for_cooldown,name=soul_reaper,if=talent.soul_reaper&target.time_to_pct_35<5&fight_remains>5&cooldown.soul_reaper.remains<(gcd*0.75)&active_enemies=1"
# Wait for Death's Due/Defile if Night Fae to get strength buff back asap
actions+="/wait_for_cooldown,name=deaths_due,if=covenant.night_fae&cooldown.deaths_due.remains<gcd&active_enemies=1"
actions+="/wait_for_cooldown,name=defile,if=covenant.night_fae&cooldown.defile.remains<gcd&active_enemies=1"
# Action Lists and Openers
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/sequence,if=active_enemies=1&!death_knight.disable_aotd&talent.summon_gargoyle,name=garg_opener:outbreak:festering_strike:festering_strike:summon_gargoyle:army_of_the_dead:death_coil,if=buff.sudden_doom.up:death_coil:death_coil:scourge_strike,if=debuff.festering_wound.stack>4:scourge_strike,if=debuff.festering_wound.stack>4:festering_strike"
actions+="/sequence,if=active_enemies=1&!death_knight.disable_aotd&!talent.summon_gargoyle,name=opener:festering_strike:festering_strike:potion:unholy_blight:dark_transformation:apocalypse"
actions+="/call_action_list,name=cooldowns"
actions+="/run_action_list,name=aoe_setup,if=variable.adds_remain&(cooldown.death_and_decay.remains<10&!talent.defile|cooldown.defile.remains<10&talent.defile|covenant.night_fae&cooldown.deaths_due.remains<10)&!death_and_decay.ticking"
actions+="/run_action_list,name=aoe_burst,if=active_enemies>=2&death_and_decay.ticking"
actions+="/run_action_list,name=generic_aoe,if=active_enemies>=2&(!death_and_decay.ticking&(cooldown.death_and_decay.remains>10&!talent.defile|cooldown.defile.remains>10&talent.defile|covenant.night_fae&cooldown.deaths_due.remains>10))"
actions+="/call_action_list,name=generic,if=active_enemies=1"

# AoE Burst
actions.aoe_burst="clawing_shadows,if=active_enemies<=5"
actions.aoe_burst+="/clawing_shadows,if=active_enemies=6&death_knight.fwounded_targets>=3"
actions.aoe_burst+="/wound_spender,if=talent.bursting_sores&(death_knight.fwounded_targets=active_enemies|death_knight.fwounded_targets>=3)|talent.bursting_sores&talent.clawing_shadows&death_knight.fwounded_targets>=1"
actions.aoe_burst+="/death_coil,if=(buff.sudden_doom.react|!variable.pooling_runic_power)&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.aoe_burst+="/epidemic,if=runic_power.deficit<(10+death_knight.fwounded_targets*3)&death_knight.fwounded_targets<6&!variable.pooling_runic_power|buff.swarming_mist.up"
actions.aoe_burst+="/epidemic,if=runic_power.deficit<25&death_knight.fwounded_targets>5&!variable.pooling_runic_power"
actions.aoe_burst+="/epidemic,if=!death_knight.fwounded_targets&!variable.pooling_runic_power|fight_remains<5|raid_event.adds.exists&raid_event.adds.remains<5"
actions.aoe_burst+="/wound_spender"
actions.aoe_burst+="/epidemic,if=!variable.pooling_runic_power"

# AoE Setup
actions.aoe_setup="any_dnd,if=death_knight.fwounded_targets=active_enemies|death_knight.fwounded_targets>=5|!talent.bursting_sores|raid_event.adds.exists&raid_event.adds.remains<=11|fight_remains<=11"
actions.aoe_setup+="/death_coil,if=!variable.pooling_runic_power&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.aoe_setup+="/epidemic,if=!variable.pooling_runic_power"
actions.aoe_setup+="/festering_strike,target_if=max:debuff.festering_wound.stack,if=debuff.festering_wound.stack<=3&cooldown.apocalypse.remains<3"
actions.aoe_setup+="/festering_strike,target_if=debuff.festering_wound.stack<1"
actions.aoe_setup+="/festering_strike,target_if=min:debuff.festering_wound.stack,if=rune.time_to_4<(cooldown.death_and_decay.remains&!talent.defile|cooldown.defile.remains&talent.defile|covenant.night_fae&cooldown.deaths_due.remains)"

# Potion
actions.cooldowns="potion,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=26|fight_remains<26"
# Cooldowns
actions.cooldowns+="/army_of_the_dead,if=cooldown.unholy_blight.remains<7&cooldown.dark_transformation.remains_expected<10&talent.unholy_blight&(runeforge.abominations_frenzy&time>=250|!runeforge.abominations_frenzy)&(cooldown.apocalypse.remains_expected<10&variable.full_cdr|!variable.full_cdr)|!talent.unholy_blight|fight_remains<35"
actions.cooldowns+="/soul_reaper,target_if=target.time_to_pct_35<5&target.time_to_die>5&active_enemies<=3"
# Holds Blight for up to 5 seconds to sync with Apocalypse, Otherwise, use with Dark Transformation.
actions.cooldowns+="/unholy_blight,if=variable.st_planning&(cooldown.apocalypse.remains_expected<5|cooldown.apocalypse.remains_expected>10)&(cooldown.dark_transformation.remains<gcd|buff.dark_transformation.up)"
actions.cooldowns+="/unholy_blight,if=variable.adds_remain|fight_remains<21"
actions.cooldowns+="/dark_transformation,if=variable.st_planning&(dot.unholy_blight_dot.remains|!talent.unholy_blight)"
actions.cooldowns+="/dark_transformation,if=variable.adds_remain|fight_remains<21"
actions.cooldowns+="/apocalypse,if=active_enemies=1&debuff.festering_wound.stack>=4&(!variable.full_cdr|variable.full_cdr&(cooldown.unholy_blight.remains>10|cooldown.dark_transformation.remains_expected>10&!talent.unholy_blight))"
actions.cooldowns+="/apocalypse,target_if=max:debuff.festering_wound.stack,if=active_enemies>=2&debuff.festering_wound.stack>=4&!death_and_decay.ticking"
actions.cooldowns+="/summon_gargoyle,if=runic_power.deficit<14&cooldown.unholy_blight.remains<13&cooldown.dark_transformation.remains_expected<13"
actions.cooldowns+="/unholy_assault,if=variable.st_planning&debuff.festering_wound.stack<2&(pet.apoc_ghoul.active|buff.dark_transformation.up&cooldown.apocalypse.remains>10|cooldown.apocalypse.remains>10&cooldown.dark_transformation.remains>10)"
actions.cooldowns+="/unholy_assault,target_if=min:debuff.festering_wound.stack,if=active_enemies>=2&debuff.festering_wound.stack<2&(pet.apoc_ghoul.active|buff.dark_transformation.up|cooldown.death_and_decay.remains<gcd)"
actions.cooldowns+="/raise_dead,if=!pet.ghoul.active"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&!buff.dark_transformation.up&cooldown.dark_transformation.remains>5|fight_remains<gcd"

# Covenant Abilities
actions.covenants="swarming_mist,if=variable.st_planning&runic_power.deficit>16&(cooldown.apocalypse.remains|!talent.army_of_the_damned&cooldown.dark_transformation.remains)|fight_remains<11"
# Set to use after apoc is on CD as to prevent overcapping RP while setting up CD's
actions.covenants+="/swarming_mist,if=cooldown.apocalypse.remains&(active_enemies>=2&active_enemies<=5&runic_power.deficit>10+(active_enemies*6)&variable.adds_remain|active_enemies>5&runic_power.deficit>40)"
actions.covenants+="/abomination_limb,if=variable.st_planning&!soulbind.lead_by_example&!runeforge.abominations_frenzy&(cooldown.apocalypse.remains|!talent.army_of_the_damned&cooldown.dark_transformation.remains)&rune.time_to_4>buff.runic_corruption.remains|fight_remains<21"
actions.covenants+="/abomination_limb,if=variable.st_planning&(soulbind.lead_by_example|runeforge.abominations_frenzy)&(dot.unholy_blight_dot.remains>11|!talent.unholy_blight&cooldown.dark_transformation.remains)"
actions.covenants+="/abomination_limb,if=variable.st_planning&soulbind.kevins_oozeling&!runeforge.abominations_frenzy&debuff.festering_wound.stack>=4"
actions.covenants+="/abomination_limb,if=variable.adds_remain&rune.time_to_4>buff.runic_corruption.remains"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.apocalypse.remains>10|!talent.army_of_the_damned&cooldown.dark_transformation.remains)|fight_remains<15"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain&(death_and_decay.ticking|raid_event.adds.remains<=14)"
actions.covenants+="/fleshcraft,if=soulbind.pustule_eruption|soulbind.volatile_solvent,interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Single Target
actions.generic="death_coil,if=!variable.pooling_runic_power&(buff.sudden_doom.react|runic_power.deficit<=13)|pet.gargoyle.active&rune<=3|fight_remains<10&!debuff.festering_wound.up"
actions.generic+="/any_dnd,if=(talent.defile.enabled|covenant.night_fae|runeforge.phearomones)&(!variable.pooling_runes|fight_remains<5)"
actions.generic+="/wound_spender,if=variable.dump_wounds&debuff.festering_wound.stack>=1&cooldown.apocalypse.remains_expected>5&!variable.pooling_runes"
actions.generic+="/wound_spender,if=debuff.festering_wound.stack>3&!variable.pooling_runes|debuff.festering_wound.up&fight_remains<(debuff.festering_wound.stack*gcd)"
actions.generic+="/death_coil,if=runic_power.deficit<=20&!variable.pooling_runic_power"
actions.generic+="/festering_strike,if=debuff.festering_wound.stack<4&!variable.pooling_runes"
actions.generic+="/death_coil,if=!variable.pooling_runic_power"
actions.generic+="/wound_spender,if=debuff.festering_wound.stack>=1&rune<2&!variable.pooling_runes&cooldown.apocalypse.remains_expected>5"

# Generic AoE Priority
actions.generic_aoe="wait_for_cooldown,name=soul_reaper,if=talent.soul_reaper&target.time_to_pct_35<5&fight_remains>5&cooldown.soul_reaper.remains<(gcd*0.75)&active_enemies<=3"
actions.generic_aoe+="/death_coil,if=(!variable.pooling_runic_power|buff.sudden_doom.react)&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.generic_aoe+="/epidemic,if=buff.sudden_doom.react|!variable.pooling_runic_power"
actions.generic_aoe+="/wound_spender,target_if=max:debuff.festering_wound.stack,if=(cooldown.apocalypse.remains>5&debuff.festering_wound.up|debuff.festering_wound.stack>4)&(fight_remains<cooldown.death_and_decay.remains+10|fight_remains>cooldown.apocalypse.remains)"
actions.generic_aoe+="/festering_strike,target_if=max:debuff.festering_wound.stack,if=debuff.festering_wound.stack<=3&cooldown.apocalypse.remains<5|debuff.festering_wound.stack<1"
actions.generic_aoe+="/festering_strike,target_if=min:debuff.festering_wound.stack,if=cooldown.apocalypse.remains>5&debuff.festering_wound.stack<1"

# Racials
actions.racials="arcane_torrent,if=runic_power.deficit>65&(pet.gargoyle.active|!talent.summon_gargoyle.enabled)&rune.deficit>=5"
actions.racials+="/blood_fury,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.blood_fury.duration|fight_remains<=buff.blood_fury.duration"
actions.racials+="/berserking,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.berserking.duration|fight_remains<=buff.berserking.duration"
actions.racials+="/lights_judgment,if=buff.unholy_strength.up"
# Ancestral Call can trigger 4 potential buffs, each lasting 15 seconds. Utilized hard coded time as a trigger to keep it readable.
actions.racials+="/ancestral_call,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=15|fight_remains<=15"
actions.racials+="/arcane_pulse,if=active_enemies>=2|(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/fireblood,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.fireblood.duration|fight_remains<=buff.fireblood.duration"
actions.racials+="/bag_of_tricks,if=active_enemies=1&(buff.unholy_strength.up|fight_remains<5)"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)&(active_enemies>=2|pet.army_ghoul.active|pet.apoc_ghoul.active&(talent.unholy_assault|death_knight.disable_aotd)|pet.gargoyle.active)|fight_remains<21|target.time_to_pct_20<5"
# The trinket with the highest estimated value, will be used first and paired with Apocalypse (if buff is 15 seconds or less) or Blight/DT (if greater than 15 seconds)
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&((trinket.1.proc.any_dps.duration<=15&cooldown.apocalypse.remains>20|trinket.1.proc.any_dps.duration>15&(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)|active_enemies>=2&buff.dark_transformation.up)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1))|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&((trinket.2.proc.any_dps.duration<=15&cooldown.apocalypse.remains>20|trinket.2.proc.any_dps.duration>15&(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)|active_enemies>=2&buff.dark_transformation.up)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2))|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173128"
neck="interplanar_keystone,id=186379,bonus_id=7187/1498/6935,gem_id=173128"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="grimveiled_cape,id=173242,bonus_id=6716/6952/6649/6648/1559,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173128,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173127"
legs="gormshell_greaves,id=178701,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="fleshfused_circle,id=178869,bonus_id=6536/1566/6646/6935,gem_id=173127,enchant=tenet_of_mastery"
finger2="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_mastery"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=7187/1498"
main_hand="jaithys_the_prison_blade,id=186410,bonus_id=1498/6652/7745/7746/7747,enchant=rune_of_the_fallen_crusader"

deathknight="T28_Death_Knight_Unholy_2pc"
source="default"
spec="unholy"
level="60"
race="troll"
role="attack"
position="back"
talents="2303021"
covenant="necrolord"
soulbind="plague_deviser_marileth,volatile_solvent/kevins_oozeling/brutal_grasp:11:1/eternal_hunger:11:1/convocation_of_the_dead:11:1"
renown="80"
set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=1"

# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/raise_dead"
actions.precombat+="/fleshcraft"
actions.precombat+="/army_of_the_dead,precombat_time=3,if=!talent.summon_gargoyle"
# Evaluates a trinkets cooldown, divided by 45. This was chosen as unholy works on 45 second burst cycles, but has too many cdr effects to give a cooldown.x.duration divisor instead. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(trinket.1.cooldown.duration%%45=0)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(trinket.2.cooldown.duration%%45=0)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
# Evaluates current setup for the quantity of Apocalypse CDR effects
actions.precombat+="/variable,name=full_cdr,value=talent.army_of_the_damned&conduit.convocation_of_the_dead"

# Executed every time the actor is available.
actions="auto_attack"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
# Variables
actions+="/variable,name=pooling_runic_power,value=cooldown.summon_gargoyle.remains<5&talent.summon_gargoyle&(talent.unholy_blight&cooldown.unholy_blight.remains<13&cooldown.dark_transformation.remains_expected<13|!talent.unholy_blight)"
actions+="/variable,name=pooling_runes,value=talent.soul_reaper&rune<2&target.time_to_pct_35<5&fight_remains>5"
actions+="/variable,name=st_planning,value=active_enemies=1&(!raid_event.adds.exists|raid_event.adds.in>15)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=major_cooldowns_active,value=(talent.summon_gargoyle&!pet.gargoyle.active&cooldown.summon_gargoyle.remains|!talent.summon_gargoyle)&(buff.unholy_assault.up|talent.army_of_the_damned&pet.apoc_ghoul.active|buff.dark_transformation.up|active_enemies>=2&death_and_decay.ticking)"
actions+="/variable,name=dump_wounds,value=covenant.night_fae&death_and_decay.ticking&buff.deaths_due.stack<4|buff.marrowed_gemstone_enhancement.up|buff.thrill_seeker.up|buff.frenzied_monstrosity.up|buff.lead_by_example.up|buff.chaos_bane.up|cooldown.unholy_assault.remains<5"
# Maintaining Virulent Plague is a priority
actions+="/outbreak,if=dot.virulent_plague.refreshable&!talent.unholy_blight&!raid_event.adds.exists"
actions+="/outbreak,target_if=dot.virulent_plague.refreshable&active_enemies>=2&(!talent.unholy_blight|talent.unholy_blight&(cooldown.unholy_blight.remains>(15%active_enemies+dot.virulent_plague.remains)|active_enemies>=3))"
actions+="/outbreak,if=runeforge.superstrain&(dot.frost_fever.refreshable|dot.blood_plague.refreshable)"
# Refreshes Deaths Due's buff just before deaths due ends
actions+="/wound_spender,if=covenant.night_fae&death_and_decay.active_remains<(gcd*1.5)&death_and_decay.ticking"
actions+="/wait_for_cooldown,name=soul_reaper,if=talent.soul_reaper&target.time_to_pct_35<5&fight_remains>5&cooldown.soul_reaper.remains<(gcd*0.75)&active_enemies=1"
# Wait for Death's Due/Defile if Night Fae to get strength buff back asap
actions+="/wait_for_cooldown,name=deaths_due,if=covenant.night_fae&cooldown.deaths_due.remains<gcd&active_enemies=1"
actions+="/wait_for_cooldown,name=defile,if=covenant.night_fae&cooldown.defile.remains<gcd&active_enemies=1"
# Action Lists and Openers
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/sequence,if=active_enemies=1&!death_knight.disable_aotd&talent.summon_gargoyle,name=garg_opener:outbreak:festering_strike:festering_strike:summon_gargoyle:army_of_the_dead:death_coil,if=buff.sudden_doom.up:death_coil:death_coil:scourge_strike,if=debuff.festering_wound.stack>4:scourge_strike,if=debuff.festering_wound.stack>4:festering_strike"
actions+="/sequence,if=active_enemies=1&!death_knight.disable_aotd&!talent.summon_gargoyle,name=opener:festering_strike:festering_strike:potion:unholy_blight:dark_transformation:apocalypse"
actions+="/call_action_list,name=cooldowns"
actions+="/run_action_list,name=aoe_setup,if=variable.adds_remain&(cooldown.death_and_decay.remains<10&!talent.defile|cooldown.defile.remains<10&talent.defile|covenant.night_fae&cooldown.deaths_due.remains<10)&!death_and_decay.ticking"
actions+="/run_action_list,name=aoe_burst,if=active_enemies>=2&death_and_decay.ticking"
actions+="/run_action_list,name=generic_aoe,if=active_enemies>=2&(!death_and_decay.ticking&(cooldown.death_and_decay.remains>10&!talent.defile|cooldown.defile.remains>10&talent.defile|covenant.night_fae&cooldown.deaths_due.remains>10))"
actions+="/call_action_list,name=generic,if=active_enemies=1"

# AoE Burst
actions.aoe_burst="clawing_shadows,if=active_enemies<=5"
actions.aoe_burst+="/clawing_shadows,if=active_enemies=6&death_knight.fwounded_targets>=3"
actions.aoe_burst+="/wound_spender,if=talent.bursting_sores&(death_knight.fwounded_targets=active_enemies|death_knight.fwounded_targets>=3)|talent.bursting_sores&talent.clawing_shadows&death_knight.fwounded_targets>=1"
actions.aoe_burst+="/death_coil,if=(buff.sudden_doom.react|!variable.pooling_runic_power)&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.aoe_burst+="/epidemic,if=runic_power.deficit<(10+death_knight.fwounded_targets*3)&death_knight.fwounded_targets<6&!variable.pooling_runic_power|buff.swarming_mist.up"
actions.aoe_burst+="/epidemic,if=runic_power.deficit<25&death_knight.fwounded_targets>5&!variable.pooling_runic_power"
actions.aoe_burst+="/epidemic,if=!death_knight.fwounded_targets&!variable.pooling_runic_power|fight_remains<5|raid_event.adds.exists&raid_event.adds.remains<5"
actions.aoe_burst+="/wound_spender"
actions.aoe_burst+="/epidemic,if=!variable.pooling_runic_power"

# AoE Setup
actions.aoe_setup="any_dnd,if=death_knight.fwounded_targets=active_enemies|death_knight.fwounded_targets>=5|!talent.bursting_sores|raid_event.adds.exists&raid_event.adds.remains<=11|fight_remains<=11"
actions.aoe_setup+="/death_coil,if=!variable.pooling_runic_power&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.aoe_setup+="/epidemic,if=!variable.pooling_runic_power"
actions.aoe_setup+="/festering_strike,target_if=max:debuff.festering_wound.stack,if=debuff.festering_wound.stack<=3&cooldown.apocalypse.remains<3"
actions.aoe_setup+="/festering_strike,target_if=debuff.festering_wound.stack<1"
actions.aoe_setup+="/festering_strike,target_if=min:debuff.festering_wound.stack,if=rune.time_to_4<(cooldown.death_and_decay.remains&!talent.defile|cooldown.defile.remains&talent.defile|covenant.night_fae&cooldown.deaths_due.remains)"

# Potion
actions.cooldowns="potion,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=26|fight_remains<26"
# Cooldowns
actions.cooldowns+="/army_of_the_dead,if=cooldown.unholy_blight.remains<7&cooldown.dark_transformation.remains_expected<10&talent.unholy_blight&(runeforge.abominations_frenzy&time>=250|!runeforge.abominations_frenzy)&(cooldown.apocalypse.remains_expected<10&variable.full_cdr|!variable.full_cdr)|!talent.unholy_blight|fight_remains<35"
actions.cooldowns+="/soul_reaper,target_if=target.time_to_pct_35<5&target.time_to_die>5&active_enemies<=3"
# Holds Blight for up to 5 seconds to sync with Apocalypse, Otherwise, use with Dark Transformation.
actions.cooldowns+="/unholy_blight,if=variable.st_planning&(cooldown.apocalypse.remains_expected<5|cooldown.apocalypse.remains_expected>10)&(cooldown.dark_transformation.remains<gcd|buff.dark_transformation.up)"
actions.cooldowns+="/unholy_blight,if=variable.adds_remain|fight_remains<21"
actions.cooldowns+="/dark_transformation,if=variable.st_planning&(dot.unholy_blight_dot.remains|!talent.unholy_blight)"
actions.cooldowns+="/dark_transformation,if=variable.adds_remain|fight_remains<21"
actions.cooldowns+="/apocalypse,if=active_enemies=1&debuff.festering_wound.stack>=4&(!variable.full_cdr|variable.full_cdr&(cooldown.unholy_blight.remains>10|cooldown.dark_transformation.remains_expected>10&!talent.unholy_blight))"
actions.cooldowns+="/apocalypse,target_if=max:debuff.festering_wound.stack,if=active_enemies>=2&debuff.festering_wound.stack>=4&!death_and_decay.ticking"
actions.cooldowns+="/summon_gargoyle,if=runic_power.deficit<14&cooldown.unholy_blight.remains<13&cooldown.dark_transformation.remains_expected<13"
actions.cooldowns+="/unholy_assault,if=variable.st_planning&debuff.festering_wound.stack<2&(pet.apoc_ghoul.active|buff.dark_transformation.up&cooldown.apocalypse.remains>10|cooldown.apocalypse.remains>10&cooldown.dark_transformation.remains>10)"
actions.cooldowns+="/unholy_assault,target_if=min:debuff.festering_wound.stack,if=active_enemies>=2&debuff.festering_wound.stack<2&(pet.apoc_ghoul.active|buff.dark_transformation.up|cooldown.death_and_decay.remains<gcd)"
actions.cooldowns+="/raise_dead,if=!pet.ghoul.active"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&!buff.dark_transformation.up&cooldown.dark_transformation.remains>5|fight_remains<gcd"

# Covenant Abilities
actions.covenants="swarming_mist,if=variable.st_planning&runic_power.deficit>16&(cooldown.apocalypse.remains|!talent.army_of_the_damned&cooldown.dark_transformation.remains)|fight_remains<11"
# Set to use after apoc is on CD as to prevent overcapping RP while setting up CD's
actions.covenants+="/swarming_mist,if=cooldown.apocalypse.remains&(active_enemies>=2&active_enemies<=5&runic_power.deficit>10+(active_enemies*6)&variable.adds_remain|active_enemies>5&runic_power.deficit>40)"
actions.covenants+="/abomination_limb,if=variable.st_planning&!soulbind.lead_by_example&!runeforge.abominations_frenzy&(cooldown.apocalypse.remains|!talent.army_of_the_damned&cooldown.dark_transformation.remains)&rune.time_to_4>buff.runic_corruption.remains|fight_remains<21"
actions.covenants+="/abomination_limb,if=variable.st_planning&(soulbind.lead_by_example|runeforge.abominations_frenzy)&(dot.unholy_blight_dot.remains>11|!talent.unholy_blight&cooldown.dark_transformation.remains)"
actions.covenants+="/abomination_limb,if=variable.st_planning&soulbind.kevins_oozeling&!runeforge.abominations_frenzy&debuff.festering_wound.stack>=4"
actions.covenants+="/abomination_limb,if=variable.adds_remain&rune.time_to_4>buff.runic_corruption.remains"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.apocalypse.remains>10|!talent.army_of_the_damned&cooldown.dark_transformation.remains)|fight_remains<15"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain&(death_and_decay.ticking|raid_event.adds.remains<=14)"
actions.covenants+="/fleshcraft,if=soulbind.pustule_eruption|soulbind.volatile_solvent,interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Single Target
actions.generic="death_coil,if=!variable.pooling_runic_power&(buff.sudden_doom.react|runic_power.deficit<=13)|pet.gargoyle.active&rune<=3|fight_remains<10&!debuff.festering_wound.up"
actions.generic+="/any_dnd,if=(talent.defile.enabled|covenant.night_fae|runeforge.phearomones)&(!variable.pooling_runes|fight_remains<5)"
actions.generic+="/wound_spender,if=variable.dump_wounds&debuff.festering_wound.stack>=1&cooldown.apocalypse.remains_expected>5&!variable.pooling_runes"
actions.generic+="/wound_spender,if=debuff.festering_wound.stack>3&!variable.pooling_runes|debuff.festering_wound.up&fight_remains<(debuff.festering_wound.stack*gcd)"
actions.generic+="/death_coil,if=runic_power.deficit<=20&!variable.pooling_runic_power"
actions.generic+="/festering_strike,if=debuff.festering_wound.stack<4&!variable.pooling_runes"
actions.generic+="/death_coil,if=!variable.pooling_runic_power"
actions.generic+="/wound_spender,if=debuff.festering_wound.stack>=1&rune<2&!variable.pooling_runes&cooldown.apocalypse.remains_expected>5"

# Generic AoE Priority
actions.generic_aoe="wait_for_cooldown,name=soul_reaper,if=talent.soul_reaper&target.time_to_pct_35<5&fight_remains>5&cooldown.soul_reaper.remains<(gcd*0.75)&active_enemies<=3"
actions.generic_aoe+="/death_coil,if=(!variable.pooling_runic_power|buff.sudden_doom.react)&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.generic_aoe+="/epidemic,if=buff.sudden_doom.react|!variable.pooling_runic_power"
actions.generic_aoe+="/wound_spender,target_if=max:debuff.festering_wound.stack,if=(cooldown.apocalypse.remains>5&debuff.festering_wound.up|debuff.festering_wound.stack>4)&(fight_remains<cooldown.death_and_decay.remains+10|fight_remains>cooldown.apocalypse.remains)"
actions.generic_aoe+="/festering_strike,target_if=max:debuff.festering_wound.stack,if=debuff.festering_wound.stack<=3&cooldown.apocalypse.remains<5|debuff.festering_wound.stack<1"
actions.generic_aoe+="/festering_strike,target_if=min:debuff.festering_wound.stack,if=cooldown.apocalypse.remains>5&debuff.festering_wound.stack<1"

# Racials
actions.racials="arcane_torrent,if=runic_power.deficit>65&(pet.gargoyle.active|!talent.summon_gargoyle.enabled)&rune.deficit>=5"
actions.racials+="/blood_fury,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.blood_fury.duration|fight_remains<=buff.blood_fury.duration"
actions.racials+="/berserking,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.berserking.duration|fight_remains<=buff.berserking.duration"
actions.racials+="/lights_judgment,if=buff.unholy_strength.up"
# Ancestral Call can trigger 4 potential buffs, each lasting 15 seconds. Utilized hard coded time as a trigger to keep it readable.
actions.racials+="/ancestral_call,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=15|fight_remains<=15"
actions.racials+="/arcane_pulse,if=active_enemies>=2|(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/fireblood,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.fireblood.duration|fight_remains<=buff.fireblood.duration"
actions.racials+="/bag_of_tricks,if=active_enemies=1&(buff.unholy_strength.up|fight_remains<5)"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)&(active_enemies>=2|pet.army_ghoul.active|pet.apoc_ghoul.active&(talent.unholy_assault|death_knight.disable_aotd)|pet.gargoyle.active)|fight_remains<21|target.time_to_pct_20<5"
# The trinket with the highest estimated value, will be used first and paired with Apocalypse (if buff is 15 seconds or less) or Blight/DT (if greater than 15 seconds)
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&((trinket.1.proc.any_dps.duration<=15&cooldown.apocalypse.remains>20|trinket.1.proc.any_dps.duration>15&(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)|active_enemies>=2&buff.dark_transformation.up)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1))|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&((trinket.2.proc.any_dps.duration<=15&cooldown.apocalypse.remains>20|trinket.2.proc.any_dps.duration>15&(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)|active_enemies>=2&buff.dark_transformation.up)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2))|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173128"
neck="interplanar_keystone,id=186379,bonus_id=7187/1498/6935,gem_id=173128"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="grimveiled_cape,id=173242,bonus_id=6716/6952/6649/6648/1559,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173128,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173127"
legs="gormshell_greaves,id=178701,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="fleshfused_circle,id=178869,bonus_id=6536/1566/6646/6935,gem_id=173127,enchant=tenet_of_mastery"
finger2="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_mastery"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=7187/1498"
main_hand="jaithys_the_prison_blade,id=186410,bonus_id=1498/6652/7745/7746/7747,enchant=rune_of_the_fallen_crusader"

deathknight="T28_Death_Knight_Unholy_4pc"
source="default"
spec="unholy"
level="60"
race="troll"
role="attack"
position="back"
talents="2303021"
covenant="necrolord"
soulbind="plague_deviser_marileth,volatile_solvent/kevins_oozeling/brutal_grasp:11:1/eternal_hunger:11:1/convocation_of_the_dead:11:1"
renown="80"
set_bonus="tier28_4pc=1"
set_bonus="tier28_2pc=1"

# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/raise_dead"
actions.precombat+="/fleshcraft"
actions.precombat+="/army_of_the_dead,precombat_time=3,if=!talent.summon_gargoyle"
# Evaluates a trinkets cooldown, divided by 45. This was chosen as unholy works on 45 second burst cycles, but has too many cdr effects to give a cooldown.x.duration divisor instead. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(trinket.1.cooldown.duration%%45=0)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(trinket.2.cooldown.duration%%45=0)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
# Evaluates current setup for the quantity of Apocalypse CDR effects
actions.precombat+="/variable,name=full_cdr,value=talent.army_of_the_damned&conduit.convocation_of_the_dead"

# Executed every time the actor is available.
actions="auto_attack"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
# Variables
actions+="/variable,name=pooling_runic_power,value=cooldown.summon_gargoyle.remains<5&talent.summon_gargoyle&(talent.unholy_blight&cooldown.unholy_blight.remains<13&cooldown.dark_transformation.remains_expected<13|!talent.unholy_blight)"
actions+="/variable,name=pooling_runes,value=talent.soul_reaper&rune<2&target.time_to_pct_35<5&fight_remains>5"
actions+="/variable,name=st_planning,value=active_enemies=1&(!raid_event.adds.exists|raid_event.adds.in>15)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=major_cooldowns_active,value=(talent.summon_gargoyle&!pet.gargoyle.active&cooldown.summon_gargoyle.remains|!talent.summon_gargoyle)&(buff.unholy_assault.up|talent.army_of_the_damned&pet.apoc_ghoul.active|buff.dark_transformation.up|active_enemies>=2&death_and_decay.ticking)"
actions+="/variable,name=dump_wounds,value=covenant.night_fae&death_and_decay.ticking&buff.deaths_due.stack<4|buff.marrowed_gemstone_enhancement.up|buff.thrill_seeker.up|buff.frenzied_monstrosity.up|buff.lead_by_example.up|buff.chaos_bane.up|cooldown.unholy_assault.remains<5"
# Maintaining Virulent Plague is a priority
actions+="/outbreak,if=dot.virulent_plague.refreshable&!talent.unholy_blight&!raid_event.adds.exists"
actions+="/outbreak,target_if=dot.virulent_plague.refreshable&active_enemies>=2&(!talent.unholy_blight|talent.unholy_blight&(cooldown.unholy_blight.remains>(15%active_enemies+dot.virulent_plague.remains)|active_enemies>=3))"
actions+="/outbreak,if=runeforge.superstrain&(dot.frost_fever.refreshable|dot.blood_plague.refreshable)"
# Refreshes Deaths Due's buff just before deaths due ends
actions+="/wound_spender,if=covenant.night_fae&death_and_decay.active_remains<(gcd*1.5)&death_and_decay.ticking"
actions+="/wait_for_cooldown,name=soul_reaper,if=talent.soul_reaper&target.time_to_pct_35<5&fight_remains>5&cooldown.soul_reaper.remains<(gcd*0.75)&active_enemies=1"
# Wait for Death's Due/Defile if Night Fae to get strength buff back asap
actions+="/wait_for_cooldown,name=deaths_due,if=covenant.night_fae&cooldown.deaths_due.remains<gcd&active_enemies=1"
actions+="/wait_for_cooldown,name=defile,if=covenant.night_fae&cooldown.defile.remains<gcd&active_enemies=1"
# Action Lists and Openers
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/sequence,if=active_enemies=1&!death_knight.disable_aotd&talent.summon_gargoyle,name=garg_opener:outbreak:festering_strike:festering_strike:summon_gargoyle:army_of_the_dead:death_coil,if=buff.sudden_doom.up:death_coil:death_coil:scourge_strike,if=debuff.festering_wound.stack>4:scourge_strike,if=debuff.festering_wound.stack>4:festering_strike"
actions+="/sequence,if=active_enemies=1&!death_knight.disable_aotd&!talent.summon_gargoyle,name=opener:festering_strike:festering_strike:potion:unholy_blight:dark_transformation:apocalypse"
actions+="/call_action_list,name=cooldowns"
actions+="/run_action_list,name=aoe_setup,if=variable.adds_remain&(cooldown.death_and_decay.remains<10&!talent.defile|cooldown.defile.remains<10&talent.defile|covenant.night_fae&cooldown.deaths_due.remains<10)&!death_and_decay.ticking"
actions+="/run_action_list,name=aoe_burst,if=active_enemies>=2&death_and_decay.ticking"
actions+="/run_action_list,name=generic_aoe,if=active_enemies>=2&(!death_and_decay.ticking&(cooldown.death_and_decay.remains>10&!talent.defile|cooldown.defile.remains>10&talent.defile|covenant.night_fae&cooldown.deaths_due.remains>10))"
actions+="/call_action_list,name=generic,if=active_enemies=1"

# AoE Burst
actions.aoe_burst="clawing_shadows,if=active_enemies<=5"
actions.aoe_burst+="/clawing_shadows,if=active_enemies=6&death_knight.fwounded_targets>=3"
actions.aoe_burst+="/wound_spender,if=talent.bursting_sores&(death_knight.fwounded_targets=active_enemies|death_knight.fwounded_targets>=3)|talent.bursting_sores&talent.clawing_shadows&death_knight.fwounded_targets>=1"
actions.aoe_burst+="/death_coil,if=(buff.sudden_doom.react|!variable.pooling_runic_power)&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.aoe_burst+="/epidemic,if=runic_power.deficit<(10+death_knight.fwounded_targets*3)&death_knight.fwounded_targets<6&!variable.pooling_runic_power|buff.swarming_mist.up"
actions.aoe_burst+="/epidemic,if=runic_power.deficit<25&death_knight.fwounded_targets>5&!variable.pooling_runic_power"
actions.aoe_burst+="/epidemic,if=!death_knight.fwounded_targets&!variable.pooling_runic_power|fight_remains<5|raid_event.adds.exists&raid_event.adds.remains<5"
actions.aoe_burst+="/wound_spender"
actions.aoe_burst+="/epidemic,if=!variable.pooling_runic_power"

# AoE Setup
actions.aoe_setup="any_dnd,if=death_knight.fwounded_targets=active_enemies|death_knight.fwounded_targets>=5|!talent.bursting_sores|raid_event.adds.exists&raid_event.adds.remains<=11|fight_remains<=11"
actions.aoe_setup+="/death_coil,if=!variable.pooling_runic_power&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.aoe_setup+="/epidemic,if=!variable.pooling_runic_power"
actions.aoe_setup+="/festering_strike,target_if=max:debuff.festering_wound.stack,if=debuff.festering_wound.stack<=3&cooldown.apocalypse.remains<3"
actions.aoe_setup+="/festering_strike,target_if=debuff.festering_wound.stack<1"
actions.aoe_setup+="/festering_strike,target_if=min:debuff.festering_wound.stack,if=rune.time_to_4<(cooldown.death_and_decay.remains&!talent.defile|cooldown.defile.remains&talent.defile|covenant.night_fae&cooldown.deaths_due.remains)"

# Potion
actions.cooldowns="potion,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=26|fight_remains<26"
# Cooldowns
actions.cooldowns+="/army_of_the_dead,if=cooldown.unholy_blight.remains<7&cooldown.dark_transformation.remains_expected<10&talent.unholy_blight&(runeforge.abominations_frenzy&time>=250|!runeforge.abominations_frenzy)&(cooldown.apocalypse.remains_expected<10&variable.full_cdr|!variable.full_cdr)|!talent.unholy_blight|fight_remains<35"
actions.cooldowns+="/soul_reaper,target_if=target.time_to_pct_35<5&target.time_to_die>5&active_enemies<=3"
# Holds Blight for up to 5 seconds to sync with Apocalypse, Otherwise, use with Dark Transformation.
actions.cooldowns+="/unholy_blight,if=variable.st_planning&(cooldown.apocalypse.remains_expected<5|cooldown.apocalypse.remains_expected>10)&(cooldown.dark_transformation.remains<gcd|buff.dark_transformation.up)"
actions.cooldowns+="/unholy_blight,if=variable.adds_remain|fight_remains<21"
actions.cooldowns+="/dark_transformation,if=variable.st_planning&(dot.unholy_blight_dot.remains|!talent.unholy_blight)"
actions.cooldowns+="/dark_transformation,if=variable.adds_remain|fight_remains<21"
actions.cooldowns+="/apocalypse,if=active_enemies=1&debuff.festering_wound.stack>=4&(!variable.full_cdr|variable.full_cdr&(cooldown.unholy_blight.remains>10|cooldown.dark_transformation.remains_expected>10&!talent.unholy_blight))"
actions.cooldowns+="/apocalypse,target_if=max:debuff.festering_wound.stack,if=active_enemies>=2&debuff.festering_wound.stack>=4&!death_and_decay.ticking"
actions.cooldowns+="/summon_gargoyle,if=runic_power.deficit<14&cooldown.unholy_blight.remains<13&cooldown.dark_transformation.remains_expected<13"
actions.cooldowns+="/unholy_assault,if=variable.st_planning&debuff.festering_wound.stack<2&(pet.apoc_ghoul.active|buff.dark_transformation.up&cooldown.apocalypse.remains>10|cooldown.apocalypse.remains>10&cooldown.dark_transformation.remains>10)"
actions.cooldowns+="/unholy_assault,target_if=min:debuff.festering_wound.stack,if=active_enemies>=2&debuff.festering_wound.stack<2&(pet.apoc_ghoul.active|buff.dark_transformation.up|cooldown.death_and_decay.remains<gcd)"
actions.cooldowns+="/raise_dead,if=!pet.ghoul.active"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&!buff.dark_transformation.up&cooldown.dark_transformation.remains>5|fight_remains<gcd"

# Covenant Abilities
actions.covenants="swarming_mist,if=variable.st_planning&runic_power.deficit>16&(cooldown.apocalypse.remains|!talent.army_of_the_damned&cooldown.dark_transformation.remains)|fight_remains<11"
# Set to use after apoc is on CD as to prevent overcapping RP while setting up CD's
actions.covenants+="/swarming_mist,if=cooldown.apocalypse.remains&(active_enemies>=2&active_enemies<=5&runic_power.deficit>10+(active_enemies*6)&variable.adds_remain|active_enemies>5&runic_power.deficit>40)"
actions.covenants+="/abomination_limb,if=variable.st_planning&!soulbind.lead_by_example&!runeforge.abominations_frenzy&(cooldown.apocalypse.remains|!talent.army_of_the_damned&cooldown.dark_transformation.remains)&rune.time_to_4>buff.runic_corruption.remains|fight_remains<21"
actions.covenants+="/abomination_limb,if=variable.st_planning&(soulbind.lead_by_example|runeforge.abominations_frenzy)&(dot.unholy_blight_dot.remains>11|!talent.unholy_blight&cooldown.dark_transformation.remains)"
actions.covenants+="/abomination_limb,if=variable.st_planning&soulbind.kevins_oozeling&!runeforge.abominations_frenzy&debuff.festering_wound.stack>=4"
actions.covenants+="/abomination_limb,if=variable.adds_remain&rune.time_to_4>buff.runic_corruption.remains"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.apocalypse.remains>10|!talent.army_of_the_damned&cooldown.dark_transformation.remains)|fight_remains<15"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain&(death_and_decay.ticking|raid_event.adds.remains<=14)"
actions.covenants+="/fleshcraft,if=soulbind.pustule_eruption|soulbind.volatile_solvent,interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Single Target
actions.generic="death_coil,if=!variable.pooling_runic_power&(buff.sudden_doom.react|runic_power.deficit<=13)|pet.gargoyle.active&rune<=3|fight_remains<10&!debuff.festering_wound.up"
actions.generic+="/any_dnd,if=(talent.defile.enabled|covenant.night_fae|runeforge.phearomones)&(!variable.pooling_runes|fight_remains<5)"
actions.generic+="/wound_spender,if=variable.dump_wounds&debuff.festering_wound.stack>=1&cooldown.apocalypse.remains_expected>5&!variable.pooling_runes"
actions.generic+="/wound_spender,if=debuff.festering_wound.stack>3&!variable.pooling_runes|debuff.festering_wound.up&fight_remains<(debuff.festering_wound.stack*gcd)"
actions.generic+="/death_coil,if=runic_power.deficit<=20&!variable.pooling_runic_power"
actions.generic+="/festering_strike,if=debuff.festering_wound.stack<4&!variable.pooling_runes"
actions.generic+="/death_coil,if=!variable.pooling_runic_power"
actions.generic+="/wound_spender,if=debuff.festering_wound.stack>=1&rune<2&!variable.pooling_runes&cooldown.apocalypse.remains_expected>5"

# Generic AoE Priority
actions.generic_aoe="wait_for_cooldown,name=soul_reaper,if=talent.soul_reaper&target.time_to_pct_35<5&fight_remains>5&cooldown.soul_reaper.remains<(gcd*0.75)&active_enemies<=3"
actions.generic_aoe+="/death_coil,if=(!variable.pooling_runic_power|buff.sudden_doom.react)&(buff.dark_transformation.up&runeforge.deadliest_coil&active_enemies<=3|active_enemies=2)"
actions.generic_aoe+="/epidemic,if=buff.sudden_doom.react|!variable.pooling_runic_power"
actions.generic_aoe+="/wound_spender,target_if=max:debuff.festering_wound.stack,if=(cooldown.apocalypse.remains>5&debuff.festering_wound.up|debuff.festering_wound.stack>4)&(fight_remains<cooldown.death_and_decay.remains+10|fight_remains>cooldown.apocalypse.remains)"
actions.generic_aoe+="/festering_strike,target_if=max:debuff.festering_wound.stack,if=debuff.festering_wound.stack<=3&cooldown.apocalypse.remains<5|debuff.festering_wound.stack<1"
actions.generic_aoe+="/festering_strike,target_if=min:debuff.festering_wound.stack,if=cooldown.apocalypse.remains>5&debuff.festering_wound.stack<1"

# Racials
actions.racials="arcane_torrent,if=runic_power.deficit>65&(pet.gargoyle.active|!talent.summon_gargoyle.enabled)&rune.deficit>=5"
actions.racials+="/blood_fury,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.blood_fury.duration|fight_remains<=buff.blood_fury.duration"
actions.racials+="/berserking,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.berserking.duration|fight_remains<=buff.berserking.duration"
actions.racials+="/lights_judgment,if=buff.unholy_strength.up"
# Ancestral Call can trigger 4 potential buffs, each lasting 15 seconds. Utilized hard coded time as a trigger to keep it readable.
actions.racials+="/ancestral_call,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=15|fight_remains<=15"
actions.racials+="/arcane_pulse,if=active_enemies>=2|(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/fireblood,if=variable.major_cooldowns_active|pet.gargoyle.active&pet.gargoyle.remains<=buff.fireblood.duration|fight_remains<=buff.fireblood.duration"
actions.racials+="/bag_of_tricks,if=active_enemies=1&(buff.unholy_strength.up|fight_remains<5)"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)&(active_enemies>=2|pet.army_ghoul.active|pet.apoc_ghoul.active&(talent.unholy_assault|death_knight.disable_aotd)|pet.gargoyle.active)|fight_remains<21|target.time_to_pct_20<5"
# The trinket with the highest estimated value, will be used first and paired with Apocalypse (if buff is 15 seconds or less) or Blight/DT (if greater than 15 seconds)
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&((trinket.1.proc.any_dps.duration<=15&cooldown.apocalypse.remains>20|trinket.1.proc.any_dps.duration>15&(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)|active_enemies>=2&buff.dark_transformation.up)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1))|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&((trinket.2.proc.any_dps.duration<=15&cooldown.apocalypse.remains>20|trinket.2.proc.any_dps.duration>15&(cooldown.unholy_blight.remains>20|cooldown.dark_transformation.remains_expected>20)|active_enemies>=2&buff.dark_transformation.up)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2))|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173128"
neck="interplanar_keystone,id=186379,bonus_id=7187/1498/6935,gem_id=173128"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="grimveiled_cape,id=173242,bonus_id=6716/6952/6649/6648/1559,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173128,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173127"
legs="gormshell_greaves,id=178701,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="fleshfused_circle,id=178869,bonus_id=6536/1566/6646/6935,gem_id=173127,enchant=tenet_of_mastery"
finger2="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_mastery"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=7187/1498"
main_hand="jaithys_the_prison_blade,id=186410,bonus_id=1498/6652/7745/7746/7747,enchant=rune_of_the_fallen_crusader"




deathknight="T27_Death_Knight_Frost_DW_Oblit_Baseline"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="2201012"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=0"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173129"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173129"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="dealer_xyexas_cape,id=179349,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173129"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173130"
legs="gormshell_greaves,id=178701,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_razorice"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524


deathknight="T27_Death_Knight_Frost_DW_Oblit_2pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="2201012"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173129"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173129"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="dealer_xyexas_cape,id=179349,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173129"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173130"
legs="gormshell_greaves,id=178701,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_razorice"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524


deathknight="T27_Death_Knight_Frost_DW_Oblit_4pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="2201012"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=1"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173129"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173129"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="dealer_xyexas_cape,id=179349,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173129"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173130"
legs="gormshell_greaves,id=178701,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=sinful_revelation"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524


deathknight="T27_Death_Knight_Frost_2h_Baseline"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="1201012"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=0"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173130"
neck="interplanar_keystone,id=186379,bonus_id=7187/1498/6935,gem_id=173130"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="blighted_margraves_cloak,id=178755,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173130,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173130"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173130,enchant=tenet_of_versatility"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_versatility"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="jaithys_the_prison_blade,id=186410,bonus_id=1498/7745/7746/7747,enchant=rune_of_razorice"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_2h_2pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="1201012"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173130"
neck="interplanar_keystone,id=186379,bonus_id=7187/1498/6935,gem_id=173130"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="blighted_margraves_cloak,id=178755,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173130,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173130"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173130,enchant=tenet_of_versatility"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_versatility"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="jaithys_the_prison_blade,id=186410,bonus_id=1498/7745/7746/7747,enchant=rune_of_razorice"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_2h_4pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="1201012"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=1"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173130"
neck="interplanar_keystone,id=186379,bonus_id=7187/1498/6935,gem_id=173130"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="blighted_margraves_cloak,id=178755,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173130,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="fused_bone_greatbelt,id=178734,bonus_id=6536/1566/6646/6935,gem_id=173130"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173130,enchant=tenet_of_versatility"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_versatility"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="jaithys_the_prison_blade,id=186410,bonus_id=1498/7745/7746/7747,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_Breath_Baseline"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="3101013"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=0"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173127"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173127"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="cloak_of_scarred_honor,id=186289,bonus_id=7187/1498,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173127,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="binding_of_dark_destinies,id=186352,bonus_id=7187/1498/6935,gem_id=173127"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="greaves_of_haunting_ruination,id=186353,bonus_id=7187/1498"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="phial_of_putrefaction,id=178771,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_razorice"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_Breath_2pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="3101013"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173127"
neck="trailspinner_pendant,id=178707,bonus_id=6536/1566/6646/6935,gem_id=173127"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="cloak_of_enveloping_manifestations,id=178851,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,gem_id=173127,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="waistguard_of_expurged_anguish,id=178842,bonus_id=6536/1566/6646/6935,gem_id=173127"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_razorice"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_Breath_4pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="3101013"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=1"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173127"
neck="trailspinner_pendant,id=178707,bonus_id=6536/1566/6646/6935,gem_id=173127"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="cloak_of_enveloping_manifestations,id=178851,bonus_id=6536/1566/6646,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,gem_id=173127,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="waistguard_of_expurged_anguish,id=178842,bonus_id=6536/1566/6646/6935,gem_id=173127"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="inscrutable_quantum_device,id=179350,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_hysteria"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_Icecap_Baseline"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="2201011"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=0"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173127"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173127"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="cloak_of_scarred_honor,id=186289,bonus_id=7187/1498,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173127,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="binding_of_dark_destinies,id=186352,bonus_id=7187/1498/6935,gem_id=173127"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="phial_of_putrefaction,id=178771,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_razorice"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_Icecap_2pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="2201011"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=0"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173127"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173127"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="cloak_of_scarred_honor,id=186289,bonus_id=7187/1498,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173127,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="binding_of_dark_destinies,id=186352,bonus_id=7187/1498/6935,gem_id=173127"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="phial_of_putrefaction,id=178771,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_razorice"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524

deathknight="T27_Death_Knight_Frost_Icecap_4pc"
source="default"
spec="frost"
level="60"
race="orc"
role="attack"
position="back"
talents="2201011"
covenant="necrolord"
soulbind=""plague_deviser_marileth,volatile_solvent/kevins_oozeling/accelerated_cold:11:1/everfrost:11:1/unleashed_frenzy:11:1"
renown="80"

set_bonus="tier28_4pc=1"
set_bonus="tier28_2pc=1"


# Default consumables
potion="potion_of_spectral_strength"
flask="spectral_flask_of_power"
food="feast_of_gluttonous_hedonism"
augmentation="veiled"
temporary_enchant="main_hand:shaded_sharpening_stone/off_hand:shaded_sharpening_stone"

# This default action priority list is automatically created based on your character.
# It is a attempt to provide you with a action list that is both simple and practicable,
# while resulting in a meaningful and good simulation. It may not result in the absolutely highest possible dps.
# Feel free to edit, adapt and improve it to your own needs.
# SimulationCraft is always looking for updates and improvements to the default action lists.

# Executed before combat begins. Accepts non-harmful actions only.
actions.precombat="flask"
actions.precombat+="/food"
actions.precombat+="/augmentation"
# Snapshot raid buffed stats before combat begins and pre-potting is done.
actions.precombat+="/snapshot_stats"
actions.precombat+="/fleshcraft"
# Evaluates a trinkets cooldown, divided by pillar of frost or breath of sindragosa's cooldown. If it's value has no remainder return 1, else return 0.5.
actions.precombat+="/variable,name=trinket_1_sync,op=setif,value=1,value_else=0.5,condition=trinket.1.has_use_buff&(!talent.breath_of_sindragosa&(trinket.1.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.1.cooldown.duration=0)|talent.icecap)"
actions.precombat+="/variable,name=trinket_2_sync,op=setif,value=1,value_else=0.5,condition=trinket.2.has_use_buff&(!talent.breath_of_sindragosa&(trinket.2.cooldown.duration%%cooldown.pillar_of_frost.duration=0)|talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.duration%%trinket.2.cooldown.duration=0)|talent.icecap)"
# Estimates a trinkets value by comparing the cooldown of the trinket, divided by the duration of the buff it provides. Has a strength modifier to give a higher priority to strength trinkets, as well as a modifier for if a trinket will or will not sync with cooldowns.
actions.precombat+="/variable,name=trinket_priority,op=setif,value=2,value_else=1,condition=!trinket.1.has_use_buff&trinket.2.has_use_buff|trinket.2.has_use_buff&((trinket.2.cooldown.duration%trinket.2.proc.any_dps.duration)*(1.5+trinket.2.has_buff.strength)*(variable.trinket_2_sync))>((trinket.1.cooldown.duration%trinket.1.proc.any_dps.duration)*(1.5+trinket.1.has_buff.strength)*(variable.trinket_1_sync))"
actions.precombat+="/variable,name=rw_buffs,value=talent.gathering_storm|conduit.everfrost|runeforge.biting_cold"

# Executed every time the actor is available.
actions="auto_attack"
# Prevent specified trinkets being used with automatic lines
actions+="/variable,name=specified_trinket,value=(equipped.inscrutable_quantum_device&cooldown.inscrutable_quantum_device.ready)"
actions+="/variable,name=st_planning,value=active_enemies=1&(raid_event.adds.in>15|!raid_event.adds.exists)"
actions+="/variable,name=adds_remain,value=active_enemies>=2&(!raid_event.adds.exists|raid_event.adds.exists&(raid_event.adds.remains>5|target.1.time_to_die>10))"
actions+="/variable,name=rotfc_rime,value=buff.rime.up&(!runeforge.rage_of_the_frozen_champion|runeforge.rage_of_the_frozen_champion&runic_power.deficit>8)"
actions+="/variable,name=frost_strike_conduits,value=conduit.eradicating_blow&buff.eradicating_blow.stack=2|conduit.unleashed_frenzy&buff.unleashed_frenzy.remains<(gcd*2)"
actions+="/variable,name=deaths_due_active,value=death_and_decay.ticking&covenant.night_fae"
# Apply Frost Fever, maintain Icy Talons and keep Remorseless Winter rolling
actions+="/remorseless_winter,if=conduit.everfrost&talent.gathering_storm&!talent.obliteration&cooldown.pillar_of_frost.remains"
actions+="/howling_blast,target_if=dot.frost_fever.refreshable&(talent.icecap|!buff.breath_of_sindragosa.up&talent.breath_of_sindragosa|talent.obliteration&cooldown.pillar_of_frost.remains&!buff.killing_machine.up)"
actions+="/glacial_advance,if=buff.icy_talons.remains<=gcd&talent.icy_talons&spell_targets.glacial_advance>=2&(talent.icecap|talent.breath_of_sindragosa&cooldown.breath_of_sindragosa.remains>15|talent.obliteration&!buff.pillar_of_frost.up)"
actions+="/frost_strike,if=buff.icy_talons.remains<=gcd&talent.icy_talons&(talent.icecap|talent.breath_of_sindragosa&!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains>10|talent.obliteration&!buff.pillar_of_frost.up)"
# Interrupt
actions+="/mind_freeze,if=target.debuff.casting.react"
# Choose Action list to run
actions+="/call_action_list,name=covenants"
actions+="/call_action_list,name=racials"
actions+="/call_action_list,name=trinkets"
actions+="/call_action_list,name=cooldowns"
actions+="/call_action_list,name=cold_heart,if=talent.cold_heart&(!buff.killing_machine.up|talent.breath_of_sindragosa)&((debuff.razorice.stack=5|!death_knight.runeforge.razorice)|fight_remains<=gcd)"
actions+="/run_action_list,name=bos_ticking,if=buff.breath_of_sindragosa.up"
actions+="/run_action_list,name=bos_pooling,if=talent.breath_of_sindragosa&(cooldown.breath_of_sindragosa.remains<10)&(raid_event.adds.in>25|!raid_event.adds.exists|cooldown.pillar_of_frost.remains<10&raid_event.adds.exists&raid_event.adds.in<10)"
actions+="/run_action_list,name=obliteration,if=buff.pillar_of_frost.up&talent.obliteration"
actions+="/run_action_list,name=obliteration_pooling,if=talent.obliteration&cooldown.pillar_of_frost.remains<10&(variable.st_planning|raid_event.adds.exists&raid_event.adds.in<10|!raid_event.adds.exists)"
actions+="/run_action_list,name=aoe,if=active_enemies>=2"
actions+="/call_action_list,name=standard"

# AoE Rotation
actions.aoe="remorseless_winter"
actions.aoe+="/glacial_advance,if=talent.frostscythe"
actions.aoe+="/frostscythe,if=buff.killing_machine.react&!variable.deaths_due_active"
actions.aoe+="/howling_blast,if=variable.rotfc_rime&talent.avalanche"
actions.aoe+="/glacial_advance,if=!buff.rime.up&active_enemies<=3|active_enemies>3"
# Formulaic approach to create a pseudo priority target list for applying razorice in aoe
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.aoe+="/howling_blast,if=variable.rotfc_rime"
actions.aoe+="/frostscythe,if=buff.gathering_storm.up&active_enemies>2&!variable.deaths_due_active"
actions.aoe+="/obliterate,if=variable.deaths_due_active&buff.deaths_due.stack<4|buff.gathering_storm.up"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.aoe+="/frostscythe,if=!variable.deaths_due_active"
actions.aoe+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.aoe+="/glacial_advance"
actions.aoe+="/frostscythe"
actions.aoe+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"
actions.aoe+="/horn_of_winter"
actions.aoe+="/arcane_torrent"

# Breath of Sindragosa pooling rotation : starts 10s before BoS is available
actions.bos_pooling="remorseless_winter,if=active_enemies>=2|variable.rw_buffs"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react&cooldown.pillar_of_frost.remains>3"
actions.bos_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.bos_pooling+="/frostscythe,if=buff.killing_machine.react&runic_power.deficit>(15+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/frostscythe,if=runic_power.deficit>=(35+talent.runic_attenuation*5)&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=25"
actions.bos_pooling+="/glacial_advance,if=runic_power.deficit<20&spell_targets.glacial_advance>=2&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<20&cooldown.pillar_of_frost.remains>5"
actions.bos_pooling+="/glacial_advance,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40&spell_targets.glacial_advance>=2"
actions.bos_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=cooldown.pillar_of_frost.remains>rune.time_to_4&runic_power.deficit<40"

# Breath of Sindragosa Active Rotation
actions.bos_ticking="obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>=(45+talent.runic_attenuation*5)"
actions.bos_ticking+="/remorseless_winter,if=variable.rw_buffs|active_enemies>=2|runic_power<32"
actions.bos_ticking+="/death_and_decay,if=runic_power<32"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime&(runic_power.deficit<55|rune.time_to_3<=gcd|runeforge.rage_of_the_frozen_champion|spell_targets.howling_blast>=2|buff.rime.remains<3)|runic_power<32"
actions.bos_ticking+="/frostscythe,if=buff.killing_machine.up&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.bos_ticking+="/horn_of_winter,if=runic_power.deficit>=40&rune.time_to_3>gcd"
actions.bos_ticking+="/frostscythe,if=spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.bos_ticking+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit>25|rune.time_to_3<gcd"
actions.bos_ticking+="/howling_blast,if=variable.rotfc_rime"
actions.bos_ticking+="/arcane_torrent,if=runic_power.deficit>50"

# Cold Heart Conditions
actions.cold_heart="chains_of_ice,if=fight_remains<gcd&(rune<2|!buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>=4+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor)|buff.killing_machine.up&(!main_hand.2h&buff.cold_heart.stack>8+runeforge.koltiras_favor|main_hand.2h&buff.cold_heart.stack>10+runeforge.koltiras_favor))"
# Use during Pillar with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&buff.pillar_of_frost.up&buff.cold_heart.stack>=10&(buff.pillar_of_frost.remains<gcd*(1+cooldown.frostwyrms_fury.ready)|buff.unholy_strength.up&buff.unholy_strength.remains<gcd|buff.chaos_bane.up&buff.chaos_bane.remains<gcd)"
# Outside of Pillar useage with Icecap/Breath
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&death_knight.runeforge.fallen_crusader&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>15&(buff.cold_heart.stack>=10&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=13)"
actions.cold_heart+="/chains_of_ice,if=!talent.obliteration&!death_knight.runeforge.fallen_crusader&buff.cold_heart.stack>=10&!buff.pillar_of_frost.up&cooldown.pillar_of_frost.remains>20"
# Prevent Cold Heart overcapping during pillar
actions.cold_heart+="/chains_of_ice,if=talent.obliteration&!buff.pillar_of_frost.up&(buff.cold_heart.stack>=14&(buff.unholy_strength.up|buff.chaos_bane.up)|buff.cold_heart.stack>=19|cooldown.pillar_of_frost.remains<3&buff.cold_heart.stack>=14)"

# Potion
actions.cooldowns="potion,if=buff.pillar_of_frost.up"
# Cooldowns
actions.cooldowns+="/empower_rune_weapon,if=talent.obliteration&rune<6&(variable.st_planning|variable.adds_remain)&(cooldown.pillar_of_frost.remains<5&(cooldown.fleshcraft.remains>5&soulbind.pustule_eruption|!soulbind.pustule_eruption)|buff.pillar_of_frost.up)|fight_remains<20"
actions.cooldowns+="/empower_rune_weapon,if=talent.breath_of_sindragosa&runic_power.deficit>30&rune.time_to_5>gcd&(buff.breath_of_sindragosa.up|fight_remains<20)"
actions.cooldowns+="/empower_rune_weapon,if=talent.icecap"
actions.cooldowns+="/pillar_of_frost,if=talent.breath_of_sindragosa&(variable.st_planning|variable.adds_remain)&(cooldown.breath_of_sindragosa.remains|cooldown.breath_of_sindragosa.ready&runic_power.deficit<50)"
actions.cooldowns+="/pillar_of_frost,if=talent.icecap&!buff.pillar_of_frost.up"
actions.cooldowns+="/pillar_of_frost,if=talent.obliteration&runic_power>=25&(variable.st_planning|variable.adds_remain)&(talent.gathering_storm.enabled&buff.remorseless_winter.up|!talent.gathering_storm.enabled)"
actions.cooldowns+="/breath_of_sindragosa,if=buff.pillar_of_frost.up"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies=1&buff.pillar_of_frost.remains<gcd&buff.pillar_of_frost.up&!talent.obliteration&(!raid_event.adds.exists|raid_event.adds.in>30)|fight_remains<3"
actions.cooldowns+="/frostwyrms_fury,if=active_enemies>=2&(buff.pillar_of_frost.up|raid_event.adds.exists&raid_event.adds.in>cooldown.pillar_of_frost.remains+7)&(buff.pillar_of_frost.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<gcd)"
actions.cooldowns+="/frostwyrms_fury,if=talent.obliteration&buff.pillar_of_frost.up&((buff.pillar_of_frost.remains<gcd|buff.unholy_strength.up&buff.unholy_strength.remains<gcd)&(debuff.razorice.stack=5|!death_knight.runeforge.razorice))"
actions.cooldowns+="/hypothermic_presence,if=talent.breath_of_sindragosa&runic_power.deficit>40&rune<=3&(buff.breath_of_sindragosa.up|cooldown.breath_of_sindragosa.remains>40)|!talent.breath_of_sindragosa&runic_power.deficit>=25"
actions.cooldowns+="/raise_dead,if=cooldown.pillar_of_frost.remains<=5"
actions.cooldowns+="/sacrificial_pact,if=active_enemies>=2&(fight_remains<3|!buff.breath_of_sindragosa.up&(pet.ghoul.remains<gcd|raid_event.adds.exists&raid_event.adds.remains<3&raid_event.adds.in>pet.ghoul.remains))"
actions.cooldowns+="/death_and_decay,if=active_enemies>5|runeforge.phearomones"

# Covenant Abilities
actions.covenants="deaths_due,if=variable.st_planning|variable.adds_remain"
actions.covenants+="/swarming_mist,if=runic_power.deficit>13&cooldown.pillar_of_frost.remains<3&!talent.breath_of_sindragosa&variable.st_planning"
actions.covenants+="/swarming_mist,if=!talent.breath_of_sindragosa&variable.adds_remain"
actions.covenants+="/swarming_mist,if=talent.breath_of_sindragosa&(buff.breath_of_sindragosa.up&(variable.st_planning&runic_power.deficit>40|variable.adds_remain&runic_power.deficit>60|variable.adds_remain&raid_event.adds.remains<9&raid_event.adds.exists)|!buff.breath_of_sindragosa.up&cooldown.breath_of_sindragosa.remains)"
actions.covenants+="/abomination_limb,if=cooldown.pillar_of_frost.remains<3&variable.st_planning&(talent.breath_of_sindragosa&runic_power.deficit<60&cooldown.breath_of_sindragosa.remains<2|!talent.breath_of_sindragosa)"
actions.covenants+="/abomination_limb,if=variable.adds_remain"
actions.covenants+="/shackle_the_unworthy,if=variable.st_planning&(cooldown.pillar_of_frost.remains<3|talent.icecap)"
actions.covenants+="/shackle_the_unworthy,if=variable.adds_remain"
actions.covenants+="/fleshcraft,if=!buff.pillar_of_frost.up&(soulbind.pustule_eruption|soulbind.volatile_solvent),interrupt_immediate=1,interrupt_global=1,interrupt_if=soulbind.volatile_solvent"

# Obliteration rotation
actions.obliteration="remorseless_winter,if=active_enemies>=3&variable.rw_buffs"
actions.obliteration+="/howling_blast,target_if=!buff.killing_machine.up&rune>=3&(buff.rime.remains<3&buff.rime.up|!dot.frost_fever.ticking)"
actions.obliteration+="/glacial_advance,if=!buff.killing_machine.up&spell_targets.glacial_advance>=2|!buff.killing_machine.up&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.obliteration+="/frostscythe,if=buff.killing_machine.react&spell_targets.frostscythe>2&!variable.deaths_due_active"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime&spell_targets.howling_blast>=2"
actions.obliteration+="/glacial_advance,if=spell_targets.glacial_advance>=2"
actions.obliteration+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=!talent.avalanche&!buff.killing_machine.up|talent.avalanche&!variable.rotfc_rime|variable.rotfc_rime&rune.time_to_2>=gcd"
actions.obliteration+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice"

# Pooling For Obliteration: Starts 10 seconds before Pillar of Frost comes off CD
actions.obliteration_pooling="remorseless_winter,if=variable.rw_buffs|active_enemies>=2"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&talent.frostscythe"
actions.obliteration_pooling+="/frostscythe,if=buff.killing_machine.react&active_enemies>2&!variable.deaths_due_active"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=buff.killing_machine.react"
actions.obliteration_pooling+="/frost_strike,if=active_enemies=1&variable.frost_strike_conduits"
actions.obliteration_pooling+="/howling_blast,if=variable.rotfc_rime"
actions.obliteration_pooling+="/glacial_advance,if=spell_targets.glacial_advance>=2&runic_power.deficit<60"
actions.obliteration_pooling+="/frost_strike,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=runic_power.deficit<70"
actions.obliteration_pooling+="/obliterate,target_if=max:(debuff.razorice.stack+1)%(debuff.razorice.remains+1)*death_knight.runeforge.razorice,if=rune>=3"
actions.obliteration_pooling+="/frostscythe,if=active_enemies>=4&!variable.deaths_due_active"

# Racial Abilities
actions.racials="blood_fury,if=buff.pillar_of_frost.up"
actions.racials+="/berserking,if=buff.pillar_of_frost.up"
actions.racials+="/arcane_pulse,if=(!buff.pillar_of_frost.up&active_enemies>=2)|!buff.pillar_of_frost.up&(rune.deficit>=5&runic_power.deficit>=60)"
actions.racials+="/lights_judgment,if=buff.pillar_of_frost.up"
actions.racials+="/ancestral_call,if=buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/fireblood,if=buff.pillar_of_frost.remains<=8&buff.pillar_of_frost.up&buff.empower_rune_weapon.up"
actions.racials+="/bag_of_tricks,if=buff.pillar_of_frost.up&active_enemies=1&(buff.pillar_of_frost.remains<5&talent.cold_heart.enabled|!talent.cold_heart.enabled&buff.pillar_of_frost.remains<3)"

# Standard single-target rotation
actions.standard="remorseless_winter,if=variable.rw_buffs"
actions.standard+="/obliterate,if=buff.killing_machine.react"
actions.standard+="/howling_blast,if=variable.rotfc_rime&buff.rime.remains<3"
actions.standard+="/frost_strike,if=variable.frost_strike_conduits"
actions.standard+="/glacial_advance,if=!death_knight.runeforge.razorice&(debuff.razorice.stack<5|debuff.razorice.remains<gcd*4)"
actions.standard+="/frost_strike,if=cooldown.remorseless_winter.remains<=2*gcd&talent.gathering_storm"
actions.standard+="/howling_blast,if=variable.rotfc_rime"
actions.standard+="/frost_strike,if=runic_power.deficit<(15+talent.runic_attenuation*5)"
actions.standard+="/obliterate,if=!buff.frozen_pulse.up&talent.frozen_pulse|variable.deaths_due_active&buff.deaths_due.stack<4|talent.gathering_storm&buff.remorseless_winter.up|runic_power.deficit>(25+talent.runic_attenuation*5)"
actions.standard+="/frost_strike"
actions.standard+="/horn_of_winter"
actions.standard+="/arcane_torrent"

# Trinkets
actions.trinkets="use_item,name=inscrutable_quantum_device,if=buff.pillar_of_frost.up|target.time_to_pct_20<5|fight_remains<21"
# The trinket with the highest estimated value, will be used first and paired with Pillar of Frost.
actions.trinkets+="/use_item,slot=trinket1,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.2.has_cooldown|trinket.2.cooldown.remains|variable.trinket_priority=1)|trinket.1.proc.any_dps.duration>=fight_remains"
actions.trinkets+="/use_item,slot=trinket2,if=!variable.specified_trinket&buff.pillar_of_frost.up&(!talent.icecap|talent.icecap&buff.pillar_of_frost.remains>=10)&(!trinket.1.has_cooldown|trinket.1.cooldown.remains|variable.trinket_priority=2)|trinket.2.proc.any_dps.duration>=fight_remains"
# If only one on use trinket provides a buff, use the other on cooldown. Or if neither trinket provides a buff, use both on cooldown.
actions.trinkets+="/use_item,slot=trinket1,if=!trinket.1.has_use_buff&(trinket.2.cooldown.remains|!trinket.2.has_use_buff)|cooldown.pillar_of_frost.remains>20"
actions.trinkets+="/use_item,slot=trinket2,if=!trinket.2.has_use_buff&(trinket.1.cooldown.remains|!trinket.1.has_use_buff)|cooldown.pillar_of_frost.remains>20"

head="valorous_visage_of_krexus,id=186350,bonus_id=7187/1498/6935,gem_id=173127"
neck="interplanar_keystone,id=186379,bonus_id=6807/1498/6935,gem_id=173127"
shoulder="spires_of_broken_hope,id=186349,bonus_id=7187/1498"
back="cloak_of_scarred_honor,id=186289,bonus_id=7187/1498,enchant=soul_vitality"
chest="ancient_colossus_chassis,id=186347,bonus_id=7187/1498,enchant=eternal_stats"
wrist="vyrazs_parade_cuffs,id=186351,bonus_id=7187/1498/6935,gem_id=173127,enchant=60runspeed"
hands="cavalier_oathbreakers_grasps,id=186311,bonus_id=7187/1498,enchant=eternal_strength"
waist="binding_of_dark_destinies,id=186352,bonus_id=7187/1498/6935,gem_id=173127"
legs="legplates_of_unholy_frenzy,id=178739,bonus_id=6536/1566/6646"
feet="shadowghast_sabatons,id=171413,bonus_id=6716/7458/6649/6648/1559"
finger1="tarnished_insignia_of_quelthalas,id=186377,bonus_id=7187/1498/6935,gem_id=173127,enchant=tenet_of_critical_strike"
finger2="shadowghast_ring,id=178926,bonus_id=6647/6648/6758/6944/1559/6935,gem_id=173127,enchant=tenet_of_critical_strike"
trinket1="phial_of_putrefaction,id=178771,bonus_id=6536/1566/6646"
trinket2="old_warriors_soul,id=186438,bonus_id=1498/6807"
main_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=sinful_revelation"
off_hand="the_devouring_cold,id=187056,bonus_id=1498/6807,enchant=rune_of_the_fallen_crusader"

# Gear Summary
# gear_ilvl=256.56
# gear_strength=1119
# gear_stamina=2144
# gear_attack_power=40
# gear_crit_rating=739
# gear_haste_rating=472
# gear_mastery_rating=743
# gear_versatility_rating=277
# gear_armor=1524
